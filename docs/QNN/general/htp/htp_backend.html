

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <title>HTP &mdash; Qualcomm® AI Engine Direct</title>



  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/custom_css.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/collapsible-lists/css/tree_view.css" type="text/css" />










  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->


      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/collapsible-lists/js/CollapsibleLists.compressed.js"></script>
        <script src="../../_static/collapsible-lists/js/apply-collapsible-lists.js"></script>

    <script type="text/javascript" src="../../_static/js/theme.js"></script>


    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="HTP Core Headers for Op Packages" href="../../HTP/htp_core_headers.html" />
    <link rel="prev" title="DSP" href="../dsp/dsp_backend.html" />
</head>

<body class="wy-body-for-nav">


  <div class="wy-grid-for-nav">

    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >



            <a href="../../index.html" class="icon icon-home"> Qualcomm® AI Engine Direct



          </a>




              <div class="version">
                v2.13.0
              </div>




<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>


        </div>


        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">






              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../setup.html">Setup</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../backend.html">Backend</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../backend.html#backend-specific-pages">Backend Specific Pages</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="../dsp/dsp_backend.html">DSP</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">HTP</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#api-specializations">API Specializations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#usage-expectations">Usage Expectations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#qnn-htp-supported-operations">QNN HTP Supported Operations</a></li>
<li class="toctree-l4"><a class="reference internal" href="#qnn-htp-variable-batch">QNN HTP Variable Batch</a></li>
<li class="toctree-l4"><a class="reference internal" href="#qnn-htp-backend-api">QNN HTP Backend API</a></li>
<li class="toctree-l4"><a class="reference internal" href="#qnn-htp-performance-infrastructure-api">QNN HTP Performance Infrastructure API</a></li>
<li class="toctree-l4"><a class="reference internal" href="#qnn-htp-precision">QNN HTP Precision</a></li>
<li class="toctree-l4"><a class="reference internal" href="#qnn-htp-deep-learning-bandwidth-compression-dlbc">QNN HTP Deep Learning Bandwidth Compression (DLBC)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#qnn-htp-setting-number-of-hvx-threads">QNN HTP - Setting Number of HVX Threads</a></li>
<li class="toctree-l4"><a class="reference internal" href="#qnn-htp-backend-extensions">QNN HTP Backend Extensions</a></li>
<li class="toctree-l4"><a class="reference internal" href="#qnn-htp-profiling">QNN HTP Profiling</a></li>
<li class="toctree-l4"><a class="reference internal" href="#op-writing-guidelines">Op Writing Guidelines</a></li>
<li class="toctree-l4"><a class="reference internal" href="#recommendations-for-network-design">Recommendations for Network Design</a></li>
<li class="toctree-l4"><a class="reference internal" href="#yielding-and-pre-emption">Yielding and Pre-Emption</a></li>
<li class="toctree-l4"><a class="reference internal" href="#vtcm-sharing">VTCM Sharing</a></li>
<li class="toctree-l4"><a class="reference internal" href="#subsystem-restart-ssr">SubSystem Restart (SSR)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#htp-session-artifact-usage-guidlines">HTP Session &amp; Artifact Usage Guidlines</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../hta/hta_backend.html">HTA</a></li>
<li class="toctree-l3"><a class="reference internal" href="../cpu/cpu_backend.html">CPU</a></li>
<li class="toctree-l3"><a class="reference internal" href="../gpu/gpu_backend.html">GPU</a></li>
<li class="toctree-l3"><a class="reference internal" href="../saver/saver_backend.html">Saver</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../op_packages.html">Op Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tools.html">Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="../converters.html">Converters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quantization.html">Quantization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials.html">Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../benchmarking.html">Benchmarking</a></li>
<li class="toctree-l1"><a class="reference internal" href="../operations.html">Operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../api.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../glossary.html">Glossary</a></li>
</ul>



        </div>

      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">


      <nav class="wy-nav-top" aria-label="top navigation">

          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">Qualcomm® AI Engine Direct</a>

      </nav>


      <div class="wy-nav-content">

        <div class="rst-content">



















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">

      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>

          <li><a href="../backend.html">Backend</a> &raquo;</li>

      <li>HTP</li>


      <li class="wy-breadcrumbs-aside">



      </li>

  </ul>


  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">

  <div class="section" id="htp">
<h1>HTP<a class="headerlink" href="#htp" title="Permalink to this headline">¶</a></h1>
<p>This section provides information specific to QNN HTP backend.</p>
<ul class="simple">
<li><p><a class="reference internal" href="#api-specializations">API Specializations</a></p></li>
<li><p><a class="reference internal" href="#usage-expectations">Usage Expectations</a></p></li>
<li><p><a class="reference internal" href="#qnn-htp-supported-operations">QNN HTP Supported Operations</a></p></li>
<li><p><a class="reference internal" href="#qnn-htp-backend-api">QNN HTP Backend API</a></p></li>
<li><p><a class="reference internal" href="#qnn-htp-performance-infrastructure-api">QNN HTP Performance Infrastructure API</a></p></li>
<li><p><a class="reference internal" href="#qnn-htp-precision">QNN HTP Precision</a></p></li>
<li><p><a class="reference internal" href="#qnn-htp-deep-learning-bandwidth-compression-dlbc">QNN HTP Deep Learning Bandwidth Compression (DLBC)</a></p></li>
<li><p><a class="reference internal" href="#qnn-htp-setting-number-of-hvx-threads">QNN HTP - Setting Number of HVX Threads</a></p></li>
<li><p><a class="reference internal" href="#qnn-htp-backend-extensions">QNN HTP Backend Extensions</a></p></li>
<li><p><a class="reference internal" href="#qnn-htp-profiling">QNN HTP Profiling</a></p></li>
<li><p><a class="reference internal" href="#op-writing-guidelines">Op Writing Guidelines</a></p></li>
<li><p><a class="reference internal" href="#recommendations-for-network-design">Recommendations for Network Design</a></p></li>
<li><p><a class="reference internal" href="#vtcm-sharing">VTCM Sharing</a></p></li>
<li><p><a class="reference internal" href="#subsystem-restart-ssr">SubSystem Restart (SSR)</a></p></li>
</ul>
<div class="section" id="api-specializations">
<h2>API Specializations<a class="headerlink" href="#api-specializations" title="Permalink to this headline">¶</a></h2>
<p>This section contains information related to API specialization for the HTP backend. All QNN HTP
backend specialization is available under <code class="docutils literal notranslate"><span class="pre">&lt;QNN_SDK_ROOT&gt;/include/QNN/HTP/</span></code> directory.</p>
<p>The current version of the QNN HTP backend API is:</p>
<dl class="cpp macro">
<dt class="sig sig-object cpp">
<span class="sig-name descname"><span class="n"><span class="pre">QNN_HTP_API_VERSION_MAJOR</span></span></span> <span class="pre">5</span><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp">
<span class="sig-name descname"><span class="n"><span class="pre">QNN_HTP_API_VERSION_MINOR</span></span></span> <span class="pre">13</span><br /></dt>
<dd></dd></dl>

<dl class="cpp macro">
<dt class="sig sig-object cpp">
<span class="sig-name descname"><span class="n"><span class="pre">QNN_HTP_API_VERSION_PATCH</span></span></span> <span class="pre">0</span><br /></dt>
<dd></dd></dl>

</div>
<div class="section" id="usage-expectations">
<h2>Usage Expectations<a class="headerlink" href="#usage-expectations" title="Permalink to this headline">¶</a></h2>
<p>1. The sequence of calls to <a class="reference internal" href="../../api-rst/function_QnnGraph_8h_1a1c6363e459cb7092356572f5af1c952b.html#exhale-function-qnngraph-8h-1a1c6363e459cb7092356572f5af1c952b"><span class="std std-ref">QnnGraph_addNode()</span></a>
to build the QNN model should be done in the node dependency order.</p>
<p>2. The <a class="reference internal" href="../../api-rst/function_QnnBackend_8h_1a95dd59ad0b59872f3649f7c363c23441.html#exhale-function-qnnbackend-8h-1a95dd59ad0b59872f3649f7c363c23441"><span class="std std-ref">QnnBackend_registerOpPackage()</span></a>
takes in an optional parameter called ‘target’.</p>
<blockquote>
<div><p>Given below are the acceptable values for ‘target’</p>
<blockquote>
<div><ul>
<li><p>“CPU”   - for both linux x86 and ARM op packages</p></li>
<li><p>“HTP”   - for op package that gets loaded on the HTP.</p></li>
<li><p>nullptr</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>For ARM and HTP prepare - Registers the HTP op package</p></li>
<li><p>For linux x86           - Registers the linux x86 op package</p></li>
</ol>
</div></blockquote>
</li>
</ul>
</div></blockquote>
</div></blockquote>
<ol class="arabic simple" start="3">
<li><p>Loading a context binary generated for a different HTP arch may give indeterminate result.</p></li>
</ol>
</div>
<div class="section" id="qnn-htp-supported-operations">
<h2>QNN HTP Supported Operations<a class="headerlink" href="#qnn-htp-supported-operations" title="Permalink to this headline">¶</a></h2>
<p>QNN HTP supports running quantized 8-bit and quantized 16-bit networks on all Qualcomm SoCs.
List of operations supported by QNN HTP Quant runtime can be seen under Backend Support HTP column in
<a class="reference internal" href="../../OpDef/SupportedOps.html#supported-operations"><span class="std std-ref">Supported Operations</span></a></p>
<p>QNN HTP supports running float32 networks using float16 math on select Qualcomm SoCs.
If the QNN SDK supports QNN HTP Float, the list of operations supported by HTP Float runtime
can be seen under Backend Support HTP_FP16 column in <a class="reference internal" href="../../OpDef/SupportedOps.html#supported-operations"><span class="std std-ref">Supported Operations</span></a></p>
<p>For the QNN SDK that does support QNN HTP Float, please note that even though HTP and HTP_FP16 are
listed under separate columns in <a class="reference internal" href="../../OpDef/SupportedOps.html#supported-operations"><span class="std std-ref">Supported Operations</span></a> they are a
single “logical” backend. On select SoCs, QNN HTP backend library supports both quantized and float networks.
The separate columns is done to distinguish the different supported operations list for
quantized and float QNN HTP runtimes.</p>
</div>
<div class="section" id="qnn-htp-variable-batch">
<h2>QNN HTP Variable Batch<a class="headerlink" href="#qnn-htp-variable-batch" title="Permalink to this headline">¶</a></h2>
<p>QNN HTP supports variable batch dimension in a limited manner. The batch dimension at graph execute can be an
integer mulitple of the respective dimension provided at graph prepare. All inputs and outputs tensors must have
the same batch multiple. For example, if the tensor dimensions provided at graph prepare are [b,h,w,d] then
graph can be executed with tensor having dimensions as [n*b,h,w,d], where n is a positive integer.</p>
</div>
<div class="section" id="qnn-htp-backend-api">
<h2>QNN HTP Backend API<a class="headerlink" href="#qnn-htp-backend-api" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="../../api-rst/file_include_QNN_HTP_QnnHtpDevice.h.html#file-include-qnn-htp-qnnhtpdevice-h"><span class="std std-ref">File QnnHtpDevice.h</span></a> is the backend specialization header that goes along with
<a class="reference internal" href="../../api-rst/file_include_QNN_QnnDevice.h.html#file-include-qnn-qnndevice-h"><span class="std std-ref">File QnnDevice.h</span></a>. This header file allows clients to configure the QnnDevice to
cater to specific use-cases.</p>
<p><a class="reference internal" href="../../api-rst/structQnnHtpGraph__CustomConfig__t.html#exhale-struct-structqnnhtpgraph-customconfig-t"><span class="std std-ref">Struct QnnHtpGraph_CustomConfig_t</span></a> is defined in <a class="reference internal" href="../../api-rst/file_include_QNN_HTP_QnnHtpGraph.h.html#file-include-qnn-htp-qnnhtpgraph-h"><span class="std std-ref">File QnnHtpGraph.h</span></a>
and is the backend specialization header that goes with <a class="reference internal" href="../../api-rst/file_include_QNN_QnnGraph.h.html#file-include-qnn-qnngraph-h"><span class="std std-ref">File QnnGraph.h</span></a></p>
<p class="centered" id="htp-device-feature-table">
<strong><strong>QNN HTP Device Config Options (QnnHtpDevice_CustomConfig_t)</strong></strong></p><table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Option Name</p></th>
<th class="head"><p>Option Description</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>When to use</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>QNN_HTP_DEVICE_CONFIG_OPTION_SOC</p></td>
<td><p>Integer value used to identify SoC model</p></td>
<td><p>QNN_SOC_MODEL_SM8350</p></td>
<td><p>Client can provide socModel to indicate which SoC is targeted</p></td>
</tr>
<tr class="row-odd"><td><p>QNN_HTP_DEVICE_CONFIG_OPTION_ARCH</p></td>
<td><p>Data structure to configure a device to set the HTP Arch. The driver will use ops
that are compatible to this HTP Arch</p></td>
<td><p>QNN_HTP_DEVICE_ARCH_NONE</p></td>
<td><p>Client can provide as part of the custom config when there are multiple devices in use</p></td>
</tr>
<tr class="row-even"><td><p>QNN_HTP_DEVICE_CONFIG_OPTION_SIGNEDPD</p></td>
<td><p>Enables signed process domain. In order to use this flag, client also needs to push a signed
dsp image to target</p></td>
<td><p>False (Unsigned Process Domain)</p></td>
<td><p>Client use signed process domain. Check Hexagon SDK document for more detail.</p></td>
</tr>
</tbody>
</table>
<p>Client can set SocModel as below:
Refer <a class="reference internal" href="../../api-rst/enum_QnnTypes_8h_1aea3262897ad2f237f9e5189419ad2214.html#exhale-enum-qnntypes-8h-1aea3262897ad2f237f9e5189419ad2214"><span class="std std-ref">Qnn_SocModel_t</span></a> for setting Soc Model.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="n">QnnHtpDevice_CustomConfig_t</span><span class="w"> </span><span class="n">customConfig</span><span class="p">;</span>
<span class="linenos">2</span><span class="n">customConfig</span><span class="p">.</span><span class="n">option</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="n">QNN_HTP_DEVICE_CONFIG_OPTION_SOC</span><span class="p">;</span>
<span class="linenos">3</span><span class="n">customConfig</span><span class="p">.</span><span class="n">socModel</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QNN_SOC_MODEL_SM8550</span><span class="p">;</span>
<span class="linenos">4</span><span class="n">QnnDevice_Config_t</span><span class="w"> </span><span class="n">devConfig</span><span class="p">;</span>
<span class="linenos">5</span><span class="n">devConfig</span><span class="p">.</span><span class="n">option</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QNN_DEVICE_CONFIG_OPTION_CUSTOM</span><span class="p">;</span>
<span class="linenos">6</span><span class="n">devConfig</span><span class="p">.</span><span class="n">customConfig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">customConfig</span><span class="p">;</span>
<span class="linenos">7</span><span class="k">const</span><span class="w"> </span><span class="n">QnnDevice_Config_t</span><span class="o">*</span><span class="w"> </span><span class="n">pDeviceConfig</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="o">&amp;</span><span class="n">devConfig</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">};</span>
</pre></div>
</div>
<p>Client can set Htp arch as below:
Refer <a class="reference internal" href="../../api-rst/enum_QnnHtpDevice_8h_1a0ed976142af98a86143459dfd326f717.html#exhale-enum-qnnhtpdevice-8h-1a0ed976142af98a86143459dfd326f717"><span class="std std-ref">QnnHtpDevice_Arch_t</span></a> for setting Htp Arch.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="n">QnnHtpDevice_CustomConfig_t</span><span class="w"> </span><span class="n">customConfig</span><span class="p">;</span>
<span class="linenos">2</span><span class="n">customConfig</span><span class="p">.</span><span class="n">option</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">QNN_HTP_DEVICE_CONFIG_OPTION_ARCH</span><span class="p">;</span>
<span class="linenos">3</span><span class="n">customConfig</span><span class="p">.</span><span class="n">arch</span><span class="p">.</span><span class="n">arch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QNN_HTP_DEVICE_ARCH_V73</span><span class="p">;</span>
<span class="linenos">4</span><span class="n">customConfig</span><span class="p">.</span><span class="n">arch</span><span class="p">.</span><span class="n">deviceId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w">  </span><span class="c1">// Id of device to be used. If single device is used by default 0.</span>
<span class="linenos">5</span><span class="n">QnnDevice_Config_t</span><span class="w"> </span><span class="n">devConfig</span><span class="p">;</span>
<span class="linenos">6</span><span class="n">devConfig</span><span class="p">.</span><span class="n">option</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QNN_DEVICE_CONFIG_OPTION_CUSTOM</span><span class="p">;</span>
<span class="linenos">7</span><span class="n">devConfig</span><span class="p">.</span><span class="n">customConfig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">customConfig</span><span class="p">;</span>
<span class="linenos">8</span><span class="k">const</span><span class="w"> </span><span class="n">QnnDevice_Config_t</span><span class="o">*</span><span class="w"> </span><span class="n">pDeviceConfig</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="o">&amp;</span><span class="n">devConfig</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">};</span>
</pre></div>
</div>
<p>Client can set signed PD as below:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="n">QnnHtpDevice_CustomConfig_t</span><span class="w"> </span><span class="n">customConfig</span><span class="p">;</span>
<span class="linenos">2</span><span class="n">customConfig</span><span class="p">.</span><span class="n">option</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">QNN_HTP_DEVICE_CONFIG_OPTION_SIGNEDPD</span><span class="p">;</span>
<span class="linenos">3</span><span class="n">customConfig</span><span class="p">.</span><span class="n">useSignedProcessDomain</span><span class="p">.</span><span class="n">useSignedProcessDomain</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">true</span><span class="p">;</span>
<span class="linenos">4</span><span class="n">customConfig</span><span class="p">.</span><span class="n">useSignedProcessDomain</span><span class="p">.</span><span class="n">deviceId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w">   </span><span class="c1">// Id of device to be used. If single device is used by default 0.</span>
<span class="linenos">5</span><span class="n">QnnDevice_Config_t</span><span class="w"> </span><span class="n">devConfig</span><span class="p">;</span>
<span class="linenos">6</span><span class="n">devConfig</span><span class="p">.</span><span class="n">option</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QNN_DEVICE_CONFIG_OPTION_CUSTOM</span><span class="p">;</span>
<span class="linenos">7</span><span class="n">devConfig</span><span class="p">.</span><span class="n">customConfig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">customConfig</span><span class="p">;</span>
<span class="linenos">8</span><span class="k">const</span><span class="w"> </span><span class="n">QnnDevice_Config_t</span><span class="o">*</span><span class="w"> </span><span class="n">pDeviceConfig</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="o">&amp;</span><span class="n">devConfig</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">};</span>
</pre></div>
</div>
<p class="centered" id="htp-graph-feature-table">
<strong><strong>QNN HTP Graph Config Options (QnnHtpGraph_CustomConfig_t)</strong></strong></p><table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Option Name</p></th>
<th class="head"><p>Option Description</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>When to use</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>QNN_HTP_GRAPH_CONFIG_OPTION_OPTIMIZATION</p></td>
<td><p>This enum provides different HTP graph optimization options that can be used to finalize
the graph for optimum performance.</p></td>
<td><p>QNN_HTP_GRAPH_OPTIMIZATION_TYPE_UNKNOWN</p></td>
<td><p>Client can provide this option when an optimization is desired for the graph finalize process</p></td>
</tr>
<tr class="row-odd"><td><p>QNN_HTP_GRAPH_CONFIG_OPTION_PRECISION</p></td>
<td><p>An enum which defines the different precision modes supported by QNN backends</p></td>
<td><p>QNN_PRECISION_FLOAT32</p></td>
<td><p>Client provides when they desire to use a specific math type in the implementation of an operation</p></td>
</tr>
<tr class="row-even"><td><p>QNN_HTP_GRAPH_CONFIG_OPTION_VTCM_SIZE</p></td>
<td><p>Used to define the amount of VTCM memory (in MB) to reserve and utilize</p></td>
<td><p>4</p></td>
<td><p>When a client wants to use a specific amount of VTCM (&lt;= MAX_SOC_VTCM)</p></td>
</tr>
<tr class="row-odd"><td><p>QNN_HTP_GRAPH_CONFIG_OPTION_FOLD_RELU_ACTIVATION_INTO_CONV_OFF</p></td>
<td><p>For any graph where a Convolution or Convolution like operation is followed by Relu or
ReluMinMax, the relu is folded into the Convolution operation</p></td>
<td><p>always fold</p></td>
<td><p>Clients that cannot guarantee that the quantization parameters of the Relu output exactly
reflect the range of the data after the Relu should set this flag. This will come at the
cost of performance, but perserve the requested quantization encodings</p></td>
</tr>
<tr class="row-even"><td><p>QNN_HTP_GRAPH_CONFIG_OPTION_SHORT_DEPTH_CONV_ON_HMX_OFF</p></td>
<td><p>Run all Convolution operations using HMX instructions</p></td>
<td><p>always use HMX instructions</p></td>
<td><p>Clients that have graphs where weights are not symmetric and have Convolution with short
depths should set this flag to guarantee accurate results</p></td>
</tr>
<tr class="row-odd"><td><p>QNN_HTP_GRAPH_CONFIG_OPTION_NUM_HVX_THREADS</p></td>
<td><p>Used to define number of HVX threads to reserve and utilize for a particular graph</p></td>
<td><p>4</p></td>
<td><p>When a client wants to keep aside specific number of HVX threads for other parallel work
loads</p></td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Its recommended to refer Hexagon SDK documentation prior to following section as significant
functionality described here, inherently uses Hexagon SDK APIs.</p>
</div>
</div>
<div class="section" id="qnn-htp-performance-infrastructure-api">
<h2>QNN HTP Performance Infrastructure API<a class="headerlink" href="#qnn-htp-performance-infrastructure-api" title="Permalink to this headline">¶</a></h2>
<p>Clients can invoke
<a class="reference internal" href="../../api-rst/function_QnnDevice_8h_1ae5b2937f9fa4f720815b7380016d9d4e.html#exhale-function-qnndevice-8h-1ae5b2937f9fa4f720815b7380016d9d4e"><span class="std std-ref">QnnDevice_getInfrastructure</span></a>
after loading the QNN HTP library and then invoke methods that are available in
<a class="reference internal" href="../../api-rst/program_listing_file_include_QNN_HTP_QnnHtpPerfInfrastructure.h.html#program-listing-file-include-qnn-htp-qnnhtpperfinfrastructure-h"><span class="std std-ref">Program Listing for File QnnHtpPerfInfrastructure.h</span></a>. These APIs allow a client to control CPU and
HTP accelerator’s system settings for performance purpose.
A few use-cases are:</p>
<ol class="arabic simple">
<li><p>Set up a voting policy by controlling the core clocks and voltage corners.</p></li>
<li><p>Set up DCVS modes to achieve different performance settings as applicable to a use-case.</p></li>
<li><p>Set up a specific RPC Control Latency per session to control CPU low power modes and reduce CPU
wake-up latency impact on FastRPC. Latency critical applications recommended to vote for greater
than 0 and less than 200 us; moderate latency requirement can vote for more than 200 us or by
default 0 us without specific setting needed.</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Setting up number of threads for accelerator is not supported.
QNN Perf Infrastructure maps directly to fast RPC features on CPU side, and on HTP side maps to HAP_Power DCVS v3.
For detailed configuration of voltage corners and DCVS modes, please refer to Hexagon SDK documentation on HAP_power_set API.</p>
</div>
<p>QNN provides interface through APIs and parameters to set desired performance settings. Performance parameters consists of clock frequency corners
settings for cDSP bus and core, sleep latency as well as DCVS control parameters. DCVS is dynamic voltage scaling, where cDSP algorithm
determines best corner settings.</p>
<p><a class="reference internal" href="#performance-modes-with-htp-backend-extensions"><span class="std std-ref">Performance Parameters</span></a> table shows settings for various performance profiles.
Using QNN APIs one can set these performance settings. Below are parameters needed for performance settings and related API’s to enable the parameters in the performance infrastructure.</p>
<blockquote>
<div><p><strong>Clock Corner Settings</strong> - It is used to set Bus and Core operating corners for performance setting.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">QnnHtpPerfInfrastructure_DcvsV3_t</span><span class="w"> </span><span class="n">dcvsV3Config</span><span class="p">;</span>
</pre></div>
</div>
<p><strong>Bus Parameters</strong> - Bus params is used to set the bus clock parameters.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">dcvsV3Config</span><span class="p">.</span><span class="n">setBusParams</span><span class="w">            </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">    </span><span class="c1">//True to consider Bus parameter otherwise False. refer QnnHtpPerfInfrastructure.h</span>
<span class="n">dcvsV3Config</span><span class="p">.</span><span class="n">busVoltageCornerMin</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">DCVS_VOLTAGE_VCORNER_TURBO</span><span class="p">;</span>
<span class="n">dcvsV3Config</span><span class="p">.</span><span class="n">busVoltageCornerTarget</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">DCVS_VOLTAGE_VCORNER_TURBO</span><span class="p">;</span>
<span class="n">dcvsV3Config</span><span class="p">.</span><span class="n">busVoltageCornerMax</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">DCVS_VOLTAGE_VCORNER_TURBO</span><span class="p">;</span>
</pre></div>
</div>
<p><strong>Core Parameters</strong> - Core params is used to set the core clock parameters.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">dcvsV3Config</span><span class="p">.</span><span class="n">setCoreParams</span><span class="w">            </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">     </span><span class="c1">//True to consider Core parameter otherwise False. refer QnnHtpPerfInfrastructure.h</span>
<span class="n">dcvsV3Config</span><span class="p">.</span><span class="n">coreVoltageCornerMin</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">DCVS_VOLTAGE_VCORNER_TURBO</span><span class="p">;</span>
<span class="n">dcvsV3Config</span><span class="p">.</span><span class="n">coreVoltageCornerTarget</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">DCVS_VOLTAGE_VCORNER_TURBO</span><span class="p">;</span>
<span class="n">dcvsV3Config</span><span class="p">.</span><span class="n">coreVoltageCornerMax</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">DCVS_VOLTAGE_VCORNER_TURBO</span><span class="p">;</span>
</pre></div>
</div>
<p><strong>DCVS Enable</strong> - setDcvsEnable and dcvsEnable parameters enables user to vote for DCVS participation.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">dcvsV3Config</span><span class="p">.</span><span class="n">setDcvsEnable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="n">dcvsV3Config</span><span class="p">.</span><span class="n">dcvsEnable</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w">   </span><span class="c1">// zero value means to disable dcvs</span>
</pre></div>
</div>
<p><strong>Sleep Latency</strong> - setSleepLatency and sleepLatency parameters can be used to request for a sleep latency in micro seconds.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">dcvsV3Config</span><span class="p">.</span><span class="n">setSleepLatency</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="n">dcvsV3Config</span><span class="p">.</span><span class="n">sleepLatency</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="mi">100</span><span class="p">;</span><span class="w">   </span><span class="c1">// give sleep latency value, ranges 10-65535 us</span>
</pre></div>
</div>
<p><strong>Sleep Disable</strong> - setSleepDisable and sleepDisable parameters enables user to disable sleep (all LPM modes) in HTP.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">dcvsV3Config</span><span class="p">.</span><span class="n">setSleepDisable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="n">dcvsV3Config</span><span class="p">.</span><span class="n">sleepDisable</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w">    </span><span class="c1">// non zero value means disable sleep</span>
</pre></div>
</div>
<p><strong>Power Mode</strong> - powerMode parameter enables user to request for a particular DCVS mode when set_dcvs_enable and dcvs_enable both are set to TRUE.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">dcvsV3Config</span><span class="p">.</span><span class="n">powerMode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QNN_HTP_PERF_INFRASTRUCTURE_POWERMODE_PERFORMANCE_MODE</span><span class="p">;</span>
</pre></div>
</div>
</div></blockquote>
<p><strong>QNN HTP Performance Infrastructure APIs</strong> provides interface to the client to control the performance and system settings of the QNN HTP Accelerator.</p>
<blockquote>
<div><p><strong>Create Power Config ID</strong> - This API is used to associate unique client context so that subsequent APIs can refer to the same context using created ID.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">Qnn_ErrorHandle_t</span><span class="w"> </span><span class="nf">createPowerConfigId</span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">deviceId</span><span class="p">,</span><span class="w"> </span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">coreId</span><span class="p">,</span><span class="w"> </span><span class="kt">uint32_t</span><span class="o">*</span><span class="w"> </span><span class="n">powerConfigId</span><span class="p">);</span>

<span class="c1">//Usage</span>
<span class="kt">uint32_t</span><span class="w"> </span><span class="n">powerConfigId</span><span class="p">;</span><span class="w">  </span><span class="c1">// Below api creates the power config id.</span>
<span class="kt">uint32_t</span><span class="w"> </span><span class="n">deviceId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="kt">uint32_t</span><span class="w"> </span><span class="n">coreId</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="n">sample_app</span><span class="o">::</span><span class="n">StatusCode</span><span class="w"> </span><span class="nf">sample_app::QnnSampleApp::createPowerConfigId</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">QnnDevice_Infrastructure_t</span><span class="w"> </span><span class="n">deviceInfra</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nullptr</span><span class="p">;</span>
<span class="w">    </span><span class="n">QnnInterface_t</span><span class="w"> </span><span class="n">qnnInterface</span><span class="p">;</span>
<span class="w">    </span><span class="n">Qnn_ErrorHandle_t</span><span class="w"> </span><span class="n">devErr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">qnnInterface</span><span class="p">.</span><span class="n">QNN_INTERFACE_VER_NAME</span><span class="p">.</span><span class="n">deviceGetInfrastructure</span><span class="p">(</span><span class="o">&amp;</span><span class="n">deviceInfra</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">devErr</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">QNN_SUCCESS</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">QNN_ERROR</span><span class="p">(</span><span class="s">&quot;device error&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">StatusCode</span><span class="o">::</span><span class="n">FAILURE</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="n">QnnHtpDevice_Infrastructure_t</span><span class="w"> </span><span class="o">*</span><span class="n">htpInfra</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">static_cast</span><span class="o">&lt;</span><span class="n">QnnHtpDevice_Infrastructure_t</span><span class="w"> </span><span class="o">*&gt;</span><span class="p">(</span><span class="n">deviceInfra</span><span class="p">);</span>
<span class="w">    </span><span class="n">QnnHtpDevice_PerfInfrastructure_t</span><span class="w"> </span><span class="n">perfInfra</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">htpInfra</span><span class="o">-&gt;</span><span class="n">perfInfra</span><span class="p">;</span>
<span class="w">    </span><span class="n">Qnn_ErrorHandle_t</span><span class="w"> </span><span class="n">perfInfraErr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">perfInfra</span><span class="p">.</span><span class="n">createPowerConfigId</span><span class="p">(</span><span class="n">deviceId</span><span class="p">,</span><span class="w"> </span><span class="n">coreId</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">powerConfigId</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">perfInfraErr</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">QNN_SUCCESS</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">QNN_ERROR</span><span class="p">(</span><span class="s">&quot;createPowerConfigId failed&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">StatusCode</span><span class="o">::</span><span class="n">FAILURE</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">StatusCode</span><span class="o">::</span><span class="n">SUCCESS</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Set Power Config</strong> - This API allows client to set up system power configuration that will enable different performance modes.
This API uses HAP_power_dcvs_v3_payload struct to config HAP power parameters. Detailed HAP power parameters description please
refer to Hexagon SDK HAP_power_dcvs_v3_payload documentation. setPowerConfig API below has settings which gives high performance,
users can experiment with different settings according to their requirements.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">Qnn_ErrorHandle_t</span><span class="w"> </span><span class="nf">setPowerConfig</span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">powerConfigId</span><span class="p">,</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">QnnHtpPerfInfrastructure_PowerConfig_t</span><span class="o">**</span><span class="w"> </span><span class="n">config</span><span class="p">);</span>

<span class="c1">//Usage</span>
<span class="n">sample_app</span><span class="o">::</span><span class="n">StatusCode</span><span class="w"> </span><span class="nf">sample_app::QnnSampleApp::setPowerConfig</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">QnnDevice_Infrastructure_t</span><span class="w"> </span><span class="n">deviceInfra</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nullptr</span><span class="p">;</span>
<span class="w">    </span><span class="n">QnnInterface_t</span><span class="w"> </span><span class="n">qnnInterface</span><span class="p">;</span>
<span class="w">    </span><span class="n">Qnn_ErrorHandle_t</span><span class="w"> </span><span class="n">devErr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">qnnInterface</span><span class="p">.</span><span class="n">QNN_INTERFACE_VER_NAME</span><span class="p">.</span><span class="n">deviceGetInfrastructure</span><span class="p">(</span><span class="o">&amp;</span><span class="n">deviceInfra</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">devErr</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">QNN_SUCCESS</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">QNN_ERROR</span><span class="p">(</span><span class="s">&quot;device error&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">StatusCode</span><span class="o">::</span><span class="n">FAILURE</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">QnnHtpDevice_Infrastructure_t</span><span class="w"> </span><span class="o">*</span><span class="n">htpInfra</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">static_cast</span><span class="o">&lt;</span><span class="n">QnnHtpDevice_Infrastructure_t</span><span class="w"> </span><span class="o">*&gt;</span><span class="p">(</span><span class="n">deviceInfra</span><span class="p">);</span>
<span class="w">    </span><span class="n">QnnHtpDevice_PerfInfrastructure_t</span><span class="w"> </span><span class="n">perfInfra</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">htpInfra</span><span class="o">-&gt;</span><span class="n">perfInfra</span><span class="p">;</span>

<span class="w">    </span><span class="n">QnnHtpPerfInfrastructure_PowerConfig_t</span><span class="w"> </span><span class="n">powerConfig</span><span class="p">;</span>
<span class="w">    </span><span class="n">memset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">powerConfig</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">powerConfig</span><span class="p">));</span>
<span class="w">    </span><span class="n">powerConfig</span><span class="p">.</span><span class="n">option</span><span class="w">                     </span><span class="o">=</span><span class="w"> </span><span class="n">QNN_HTP_PERF_INFRASTRUCTURE_POWER_CONFIGOPTION_DCVS_V3</span><span class="p">;</span>
<span class="w">    </span><span class="n">powerConfig</span><span class="p">.</span><span class="n">dcvsV3Config</span><span class="p">.</span><span class="n">dcvsEnable</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="c1">//True to enable Dcvs, False to disbale</span>
<span class="w">    </span><span class="n">powerConfig</span><span class="p">.</span><span class="n">dcvsV3Config</span><span class="p">.</span><span class="n">setDcvsEnable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
<span class="w">    </span><span class="n">powerConfig</span><span class="p">.</span><span class="n">dcvsV3Config</span><span class="p">.</span><span class="n">contextId</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">powerConfigId</span><span class="p">;</span><span class="w">  </span><span class="c1">//use the power config id created</span>

<span class="w">    </span><span class="c1">// refer QnnHtpPerfInfrastructure.h</span>
<span class="w">    </span><span class="n">powerConfig</span><span class="p">.</span><span class="n">dcvsV3Config</span><span class="p">.</span><span class="n">powerMode</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="n">QNN_HTP_PERF_INFRASTRUCTURE_POWERMODE_PERFORMANCE_MODE</span><span class="p">;</span>
<span class="w">    </span><span class="n">powerConfig</span><span class="p">.</span><span class="n">dcvsV3Config</span><span class="p">.</span><span class="n">setSleepLatency</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="c1">//True to consider Latency parameter otherwise False</span>
<span class="w">    </span><span class="n">powerConfig</span><span class="p">.</span><span class="n">dcvsV3Config</span><span class="p">.</span><span class="n">setBusParams</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="c1">//True to consider Bus parameter otherwise False</span>
<span class="w">    </span><span class="n">powerConfig</span><span class="p">.</span><span class="n">dcvsV3Config</span><span class="p">.</span><span class="n">setCoreParams</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="c1">//True to consider Core parameter otherwise False</span>
<span class="w">    </span><span class="n">powerConfig</span><span class="p">.</span><span class="n">dcvsV3Config</span><span class="p">.</span><span class="n">sleepDisable</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="c1">//True to disable sleep, False to re-enable sleep</span>
<span class="w">    </span><span class="n">powerConfig</span><span class="p">.</span><span class="n">dcvsV3Config</span><span class="p">.</span><span class="n">setSleepDisable</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span><span class="w"> </span><span class="c1">//True to consider sleep disable/enable parameter otherwise False</span>

<span class="w">    </span><span class="c1">//Set Sleep latency parameter</span>
<span class="w">    </span><span class="n">powerConfig</span><span class="p">.</span><span class="n">dcvsV3Config</span><span class="p">.</span><span class="n">sleepLatency</span><span class="w">    </span><span class="o">=</span><span class="w">  </span><span class="mi">40</span><span class="p">;</span><span class="w"> </span><span class="c1">// set dsp sleep latency ranges 10-65535 micro sec, refer hexagon sdk</span>

<span class="w">    </span><span class="c1">//set Bus Clock Parameters (refer QnnHtpPerfInfrastructure.h)</span>
<span class="w">    </span><span class="n">powerConfig</span><span class="p">.</span><span class="n">dcvsV3Config</span><span class="p">.</span><span class="n">busVoltageCornerMin</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">DCVS_VOLTAGE_VCORNER_MAX_VOLTAGE_CORNER</span><span class="p">;</span>
<span class="w">    </span><span class="n">powerConfig</span><span class="p">.</span><span class="n">dcvsV3Config</span><span class="p">.</span><span class="n">busVoltageCornerTarget</span><span class="w">  </span><span class="o">=</span><span class="w"> </span><span class="n">DCVS_VOLTAGE_VCORNER_MAX_VOLTAGE_CORNER</span><span class="p">;</span>
<span class="w">    </span><span class="n">powerConfig</span><span class="p">.</span><span class="n">dcvsV3Config</span><span class="p">.</span><span class="n">busVoltageCornerMax</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="n">DCVS_VOLTAGE_VCORNER_MAX_VOLTAGE_CORNER</span><span class="p">;</span>

<span class="w">    </span><span class="c1">//set Core Clock Parameters (refer QnnHtpPerfInfrastructure.h)</span>
<span class="w">    </span><span class="n">powerConfig</span><span class="p">.</span><span class="n">dcvsV3Config</span><span class="p">.</span><span class="n">coreVoltageCornerMin</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">DCVS_VOLTAGE_VCORNER_MAX_VOLTAGE_CORNER</span><span class="p">;</span>
<span class="w">    </span><span class="n">powerConfig</span><span class="p">.</span><span class="n">dcvsV3Config</span><span class="p">.</span><span class="n">coreVoltageCornerTarget</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DCVS_VOLTAGE_VCORNER_MAX_VOLTAGE_CORNER</span><span class="p">;</span>
<span class="w">    </span><span class="n">powerConfig</span><span class="p">.</span><span class="n">dcvsV3Config</span><span class="p">.</span><span class="n">coreVoltageCornerMax</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="n">DCVS_VOLTAGE_VCORNER_MAX_VOLTAGE_CORNER</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// Set power config with different performance parameters</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">QnnHtpPerfInfrastructure_PowerConfig_t</span><span class="w"> </span><span class="o">*</span><span class="n">powerConfigs</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="o">&amp;</span><span class="n">powerConfig</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">};</span>

<span class="w">    </span><span class="n">Qnn_ErrorHandle_t</span><span class="w"> </span><span class="n">perfInfraErr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">perfInfra</span><span class="p">.</span><span class="n">setPowerConfig</span><span class="p">(</span><span class="n">powerConfigId</span><span class="p">,</span><span class="w"> </span><span class="n">powerConfigs</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">perfInfraErr</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">QNN_SUCCESS</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">QNN_ERROR</span><span class="p">(</span><span class="s">&quot;setPowerConfig failed&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">StatusCode</span><span class="o">::</span><span class="n">FAILURE</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">StatusCode</span><span class="o">::</span><span class="n">SUCCESS</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p><strong>Destroy Power Config ID</strong> - This API allows client to destroy power configuration id which was created earlier.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">Qnn_ErrorHandle_t</span><span class="w"> </span><span class="nf">destroyPowerConfigId</span><span class="p">(</span><span class="kt">uint32_t</span><span class="w"> </span><span class="n">powerConfigId</span><span class="p">);</span>

<span class="c1">//Usage</span>
<span class="n">sample_app</span><span class="o">::</span><span class="n">StatusCode</span><span class="w"> </span><span class="nf">sample_app::QnnSampleApp::destroyPowerConfigId</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">QnnDevice_Infrastructure_t</span><span class="w"> </span><span class="n">deviceInfra</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nullptr</span><span class="p">;</span>
<span class="w">    </span><span class="n">QnnInterface_t</span><span class="w"> </span><span class="n">qnnInterface</span><span class="p">;</span>
<span class="w">    </span><span class="n">Qnn_ErrorHandle_t</span><span class="w"> </span><span class="n">devErr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">qnnInterface</span><span class="p">.</span><span class="n">QNN_INTERFACE_VER_NAME</span><span class="p">.</span><span class="n">deviceGetInfrastructure</span><span class="p">(</span><span class="o">&amp;</span><span class="n">deviceInfra</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">devErr</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">QNN_SUCCESS</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">QNN_ERROR</span><span class="p">(</span><span class="s">&quot;device error&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">StatusCode</span><span class="o">::</span><span class="n">FAILURE</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="n">QnnHtpDevice_Infrastructure_t</span><span class="w"> </span><span class="o">*</span><span class="n">htpInfra</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">static_cast</span><span class="o">&lt;</span><span class="n">QnnHtpDevice_Infrastructure_t</span><span class="w"> </span><span class="o">*&gt;</span><span class="p">(</span><span class="n">deviceInfra</span><span class="p">);</span>
<span class="w">    </span><span class="n">QnnHtpDevice_PerfInfrastructure_t</span><span class="w"> </span><span class="n">perfInfra</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">htpInfra</span><span class="o">-&gt;</span><span class="n">perfInfra</span><span class="p">;</span>

<span class="w">    </span><span class="n">Qnn_ErrorHandle_t</span><span class="w"> </span><span class="n">perfInfraErr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">perfInfra</span><span class="p">.</span><span class="n">destroyPowerConfigId</span><span class="p">(</span><span class="n">powerConfigId</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">perfInfraErr</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">QNN_SUCCESS</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">QNN_ERROR</span><span class="p">(</span><span class="s">&quot;destroyPowerConfigId failed&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">StatusCode</span><span class="o">::</span><span class="n">FAILURE</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">StatusCode</span><span class="o">::</span><span class="n">SUCCESS</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Apart from the above API’s user can use RPC polling and control latency for better performance in high performance modes.
<strong>RPC Polling and Latency Settings</strong> - rpcPollingTimeConfig parameter can be used to request for a rpc polling time in micro seconds,
rpcControlLatencyConfig parameter can be used to reduce CPU wakeup delays.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">sample_app</span><span class="o">::</span><span class="n">StatusCode</span><span class="w"> </span><span class="nf">sample_app::QnnSampleApp::setRpcLatencyAndPolling</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">QnnDevice_Infrastructure_t</span><span class="w"> </span><span class="n">deviceInfra</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nullptr</span><span class="p">;</span>
<span class="w">    </span><span class="n">QnnInterface_t</span><span class="w"> </span><span class="n">qnnInterface</span><span class="p">;</span>
<span class="w">    </span><span class="n">Qnn_ErrorHandle_t</span><span class="w"> </span><span class="n">devErr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">qnnInterface</span><span class="p">.</span><span class="n">QNN_INTERFACE_VER_NAME</span><span class="p">.</span><span class="n">deviceGetInfrastructure</span><span class="p">(</span><span class="o">&amp;</span><span class="n">deviceInfra</span><span class="p">);</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">devErr</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">QNN_SUCCESS</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">QNN_ERROR</span><span class="p">(</span><span class="s">&quot;device error&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">StatusCode</span><span class="o">::</span><span class="n">FAILURE</span><span class="p">;</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="n">QnnHtpDevice_Infrastructure_t</span><span class="w"> </span><span class="o">*</span><span class="n">htpInfra</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">static_cast</span><span class="o">&lt;</span><span class="n">QnnHtpDevice_Infrastructure_t</span><span class="w"> </span><span class="o">*&gt;</span><span class="p">(</span><span class="n">deviceInfra</span><span class="p">);</span>
<span class="w">    </span><span class="n">QnnHtpDevice_PerfInfrastructure_t</span><span class="w"> </span><span class="n">perfInfra</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">htpInfra</span><span class="o">-&gt;</span><span class="n">perfInfra</span><span class="p">;</span>

<span class="w">    </span><span class="c1">// set RPC Control Latency</span>
<span class="w">    </span><span class="n">QnnHtpPerfInfrastructure_PowerConfig_t</span><span class="w"> </span><span class="n">rpcControlLatency</span><span class="p">;</span><span class="w">            </span><span class="c1">// refer QnnHtpPerfInfrastructure.h</span>
<span class="w">    </span><span class="n">memset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">rpcControlLatency</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">rpcControlLatency</span><span class="p">));</span>
<span class="w">    </span><span class="n">rpcControlLatency</span><span class="p">.</span><span class="n">option</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QNN_HTP_PERF_INFRASTRUCTURE_POWER_CONFIGOPTION_RPC_CONTROL_LATENCY</span><span class="p">;</span>
<span class="w">    </span><span class="n">rpcControlLatency</span><span class="p">.</span><span class="n">rpcControlLatencyConfig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">100</span><span class="p">;</span><span class="w">         </span><span class="c1">// use rpc control latency recommended 100 us, refer hexagon sdk</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">QnnHtpPerfInfrastructure_PowerConfig_t</span><span class="w"> </span><span class="o">*</span><span class="n">powerConfigs1</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="o">&amp;</span><span class="n">rpcControlLatency</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">};</span>

<span class="w">    </span><span class="n">Qnn_ErrorHandle_t</span><span class="w"> </span><span class="n">perfInfraErr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">perfInfra</span><span class="p">.</span><span class="n">setPowerConfig</span><span class="p">(</span><span class="n">powerConfigId</span><span class="p">,</span><span class="w"> </span><span class="n">powerConfigs1</span><span class="p">);</span><span class="w">  </span><span class="c1">// set RPC latency config on power config id created</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">perfInfraErr</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">QNN_SUCCESS</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">QNN_ERROR</span><span class="p">(</span><span class="s">&quot;setPowerConfig failed&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">StatusCode</span><span class="o">::</span><span class="n">FAILURE</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="c1">// set RPC Polling</span>
<span class="w">    </span><span class="n">QnnHtpPerfInfrastructure_PowerConfig_t</span><span class="w"> </span><span class="n">rpcPollingTime</span><span class="p">;</span><span class="w">   </span><span class="c1">// refer QnnHtpPerfInfrastructure.h</span>
<span class="w">    </span><span class="n">memset</span><span class="p">(</span><span class="o">&amp;</span><span class="n">rpcPollingTime</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="k">sizeof</span><span class="p">(</span><span class="n">rpcPollingTime</span><span class="p">));</span>
<span class="w">    </span><span class="n">rpcPollingTime</span><span class="p">.</span><span class="n">option</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QNN_HTP_PERF_INFRASTRUCTURE_POWER_CONFIGOPTION_RPC_POLLING_TIME</span><span class="p">;</span>
<span class="w">    </span><span class="n">rpcPollingTime</span><span class="p">.</span><span class="n">rpcPollingTimeConfig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">9999</span><span class="p">;</span><span class="w">     </span><span class="c1">// use rpc polling time recommended 0-10000 us</span>
<span class="w">    </span><span class="k">const</span><span class="w"> </span><span class="n">QnnHtpPerfInfrastructure_PowerConfig_t</span><span class="o">*</span><span class="w"> </span><span class="n">powerConfigs2</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="o">&amp;</span><span class="n">rpcPollingTime</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">};</span>

<span class="w">    </span><span class="n">Qnn_ErrorHandle_t</span><span class="w"> </span><span class="n">perfInfraErr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">perfInfra</span><span class="p">.</span><span class="n">setPowerConfig</span><span class="p">(</span><span class="n">powerConfigId</span><span class="p">,</span><span class="w"> </span><span class="n">powerConfigs2</span><span class="p">);</span><span class="w"> </span><span class="c1">// set RPC polling config on power config id created</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">perfInfraErr</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">QNN_SUCCESS</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">QNN_ERROR</span><span class="p">(</span><span class="s">&quot;setPowerConfig failed&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">StatusCode</span><span class="o">::</span><span class="n">FAILURE</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">StatusCode</span><span class="o">::</span><span class="n">SUCCESS</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ol class="arabic simple">
<li><p>RPC Latency and Polling is not supported in windows and QNX platforms</p></li>
<li><p>For detailed information on all the above performance setting parameters refer hexagon sdk documentation.</p></li>
</ol>
</div>
<p>These performance API’s can be used to boost the performance. Example application of using these API’s for performance improvement in graph execution is shown below.</p>
<blockquote>
<div><div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;HTP/QnnHtpPerfInfrastructure.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;QnnInterface.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;HTP/QnnHtpDevice.h&gt;</span>

<span class="kt">void</span><span class="w"> </span><span class="nf">example_application</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="o">-----</span>
<span class="w">    </span><span class="n">std</span><span class="o">::</span><span class="n">unique_ptr</span><span class="o">&lt;</span><span class="n">sample_app</span><span class="o">::</span><span class="n">QnnSampleApp</span><span class="o">&gt;</span><span class="w"> </span><span class="n">app</span><span class="p">;</span>
<span class="w">    </span><span class="o">-----</span>
<span class="w">    </span><span class="o">-----</span>

<span class="w">    </span><span class="n">app</span><span class="o">-&gt;</span><span class="n">createPowerConfigId</span><span class="p">();</span><span class="w">       </span><span class="c1">// Create power config id before voting</span>
<span class="w">    </span><span class="n">app</span><span class="o">-&gt;</span><span class="n">setRpcLatencyAndPolling</span><span class="p">();</span><span class="w">   </span><span class="c1">// Use RPC polling and latency for high performing modes</span>
<span class="w">    </span><span class="n">app</span><span class="o">-&gt;</span><span class="n">setPowerConfig</span><span class="p">();</span><span class="w">            </span><span class="c1">// Set the different configurations for performance settings</span>

<span class="w">    </span><span class="o">-----</span>
<span class="w">    </span><span class="n">app</span><span class="o">-&gt;</span><span class="n">executeGraphs</span><span class="p">();</span><span class="w">             </span><span class="c1">// Execute the graphs</span>
<span class="w">    </span><span class="o">-----</span>

<span class="w">    </span><span class="n">app</span><span class="o">-&gt;</span><span class="n">destroyPowerConfigId</span><span class="p">();</span><span class="w">      </span><span class="c1">// Destroy the power config id</span>
<span class="w">    </span><span class="o">-----</span>
<span class="w">    </span><span class="o">-----</span>
<span class="p">}</span>
</pre></div>
</div>
</div></blockquote>
<p>The above example app shown is purely for usage purpose. Clients can use their own settings for performance in these API’s and use them according to their requirements.</p>
<blockquote>
<div><p><strong>Use Case Examples</strong></p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">Voting</span> <span class="pre">at</span> <span class="pre">Every</span> <span class="pre">Inference</span></code> - This case depicts simple use case of setting certain performance setting (possibly higher
performance configuration) before executing inference request, followed by another performance setting (possibly lower
performance configuration). Figure below shows the call flow of setting performance setting at every inference.</p>
<div class="figure align-default">
<img alt="../../_static/resources/htp_other_performance_profile.png" src="../../_static/resources/htp_other_performance_profile.png" />
</div>
<p><code class="docutils literal notranslate"><span class="pre">Sustain</span> <span class="pre">Setting</span> <span class="pre">for</span> <span class="pre">Multiple</span> <span class="pre">Inference</span></code> - This case depicts the sustenance of performance setting (possibly higher performance configuration)
for multiple inferences. This can be achieved using system timer. Client can start a timer for certain duration
(higher than expected time between successive inferences) after setting performance vote (possibly higher performance).
This vote gets reset (possibly with lower performance) either when timer expires or when client requests to change
the performance settings. Figure below shows the call flow of sustaining performance setting for multiple inferences.</p>
<div class="figure align-default">
<img alt="../../_static/resources/htp_sustained_performance_profile.png" src="../../_static/resources/htp_sustained_performance_profile.png" />
</div>
</div></blockquote>
</div></blockquote>
<p><span class="xref std std-ref">exhale_typedef_QnnHtpDevice_8h_1a971db463066e1f912bd98b4f74393dcf</span> is a backend specific subcomponent
of <a class="reference internal" href="../../api-rst/structQnnDevice__HardwareDeviceInfo__t.html#exhale-struct-structqnndevice-hardwaredeviceinfo-t"><span class="std std-ref">Struct QnnDevice_HardwareDeviceInfo_t</span></a>. Information for these structs are provided by the
client for offline operation, and can be populated by a call to <a class="reference internal" href="../../api-rst/function_QnnDevice_8h_1af1ad41deb166ea77b455603e3f88c992.html#exhale-function-qnndevice-8h-1af1ad41deb166ea77b455603e3f88c992"><span class="std std-ref">QnnDevice_getPlatformInfo()</span></a></p>
<p class="centered" id="htp-device-info-feature-table">
<strong><strong>QNN HTP Device Info Extension Options (QnnHtpDevice_DeviceInfoExtension_t)</strong></strong></p><table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Option Name</p></th>
<th class="head"><p>Option Description</p></th>
<th class="head"><p>Default</p></th>
<th class="head"><p>When to use</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>QNN_HTP_DEVICE_CONFIG_OPTION_PCIE_DEVICE_INFO_EXTENSION</p></td>
<td><p>This structure provides info about the device that connect with PCIe bus: VTCM size (in MB), socModel,
number of NSPs on the PCIe device, signed PD support, DLBC support, device architecture</p></td>
<td><p>NULL</p></td>
<td><p>For online operation, caller should get these info from QnnDevice_getPlatformInfo. For
offline operation, caller need to create this structure and filling the correct
information for QnnDevice_create</p></td>
</tr>
<tr class="row-odd"><td><p>QNN_HTP_DEVICE_CONFIG_OPTION_ON_CHIP_DEVICE_INFO_EXTENSION</p></td>
<td><p>This structure provides info about the NSP device inside SoC: VTCM size (in MB), socModel, signed PD
support, DLBC support, device architecture</p></td>
<td><p>NULL</p></td>
<td><p>For online operation, caller should get these info from QnnDevice_getPlatformInfo. For
offline operation, caller need to create this structure and filling the correct
information for QnnDevice_create</p></td>
</tr>
</tbody>
</table>
</div>
<div class="section" id="qnn-htp-precision">
<h2>QNN HTP Precision<a class="headerlink" href="#qnn-htp-precision" title="Permalink to this headline">¶</a></h2>
<p>QNN HTP supports running graphs having a mix of floating-point and fixed-point data types.
Set the ‘relaxed_precision_flag’, when using a mixed precision graph with FP16 ops.</p>
<p>QNN HTP can support running float32 graphs on select Qualcomm SoCs. The client is expected to set up
the QNN graph with float32 tensors and QNN HTP accelerator will finalize and execute the QNN graph
using float16 math.</p>
<p>QNN HTP Clients attempting to run float32 graphs should invoke
<a class="reference internal" href="../../api-rst/function_QnnGraph_8h_1acef7b5c50463d8b02bb4abd769ae5ea9.html#exhale-function-qnngraph-8h-1acef7b5c50463d8b02bb4abd769ae5ea9"><span class="std std-ref">QnnGraph_create()</span></a> with a
<a class="reference internal" href="../../api-rst/structQnnGraph__Config__t.html#exhale-struct-structqnngraph-config-t"><span class="std std-ref">Struct QnnGraph_Config_t</span></a> which will include a
<a class="reference internal" href="../../api-rst/structQnnHtpGraph__CustomConfig__t.html#exhale-struct-structqnnhtpgraph-customconfig-t"><span class="std std-ref">Struct QnnHtpGraph_CustomConfig_t</span></a> with a config to set a
<a class="reference internal" href="../../api-rst/enum_QnnTypes_8h_1a191443d3820cd5f895cfa381148b4724.html#exhale-enum-qnntypes-8h-1a191443d3820cd5f895cfa381148b4724"><span class="std std-ref">Enum Qnn_Precision_t</span></a>.
The precision value expected to be set is QNN_PRECISION_FLOAT16.</p>
<p>A client usage would look like below:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="w"> </span><span class="n">QnnHtpGraph_CustomConfig_t</span><span class="w"> </span><span class="n">customConfig</span><span class="p">;</span>
<span class="linenos">2</span><span class="w"> </span><span class="n">customConfig</span><span class="p">.</span><span class="n">option</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QNN_HTP_GRAPH_CONFIG_OPTION_PRECISION</span><span class="p">;</span>
<span class="linenos">3</span><span class="w"> </span><span class="n">customConfig</span><span class="p">.</span><span class="n">precision</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QNN_PRECISION_FLOAT16</span><span class="p">;</span>
<span class="linenos">4</span><span class="w"> </span><span class="n">QnnGraph_Config_t</span><span class="w"> </span><span class="n">graphConfig</span><span class="p">;</span>
<span class="linenos">5</span><span class="w"> </span><span class="n">graphConfig</span><span class="p">.</span><span class="n">option</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="n">QNN_GRAPH_CONFIG_OPTION_CUSTOM</span><span class="p">;</span>
<span class="linenos">6</span><span class="w"> </span><span class="n">graphConfig</span><span class="p">.</span><span class="n">customConfig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">customConfig</span><span class="p">;</span>
<span class="linenos">7</span>
<span class="linenos">8</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">QnnGraph_Config_t</span><span class="o">*</span><span class="w"> </span><span class="n">pGraphConfig</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="o">&amp;</span><span class="n">graphConfig</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">};</span>
</pre></div>
</div>
<p>When precision value is set to QNN_PRECISION_FLOAT16, QNN HTP backend will convert user provided float32 inputs
in <a class="reference internal" href="../../api-rst/function_QnnGraph_8h_1a3ea05f42a9295f9a74a2e3a0cdd64228.html#exhale-function-qnngraph-8h-1a3ea05f42a9295f9a74a2e3a0cdd64228"><span class="std std-ref">QnnGraph_execute()</span></a> to float16 and
execute the graph with float16 math. The final output is provided to user as float32 outputs.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Setting precision value to QNN_PRECISION_FLOAT32 is not supported by QNN HTP.</p>
<p>If no precision value is set, QNN HTP backend assumes that the client expects to run quantized network.</p>
</div>
</div>
<div class="section" id="qnn-htp-deep-learning-bandwidth-compression-dlbc">
<h2>QNN HTP Deep Learning Bandwidth Compression (DLBC)<a class="headerlink" href="#qnn-htp-deep-learning-bandwidth-compression-dlbc" title="Permalink to this headline">¶</a></h2>
<p>Deep Learning Bandwidth Compression is a feature that allows inputs to be compressed so the
processing bandwidth can be lowered. QNN HTP provides a configuration option for users to turn
ON or OFF DLBC through client usage like below:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="w"> </span><span class="n">QnnHtpGraph_CustomConfig_t</span><span class="w"> </span><span class="n">customConfig</span><span class="p">;</span>
<span class="linenos"> 2</span><span class="w"> </span><span class="n">customConfig</span><span class="p">.</span><span class="n">option</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QNN_HTP_GRAPH_CONFIG_OPTION_OPTIMIZATION</span><span class="p">;</span>
<span class="linenos"> 3</span><span class="w"> </span><span class="n">customConfig</span><span class="p">.</span><span class="n">optimizationOption</span><span class="p">.</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QNN_HTP_GRAPH_OPTIMIZATION_TYPE_ENABLE_DLBC</span><span class="p">;</span>
<span class="linenos"> 4</span><span class="w"> </span><span class="n">customConfig</span><span class="p">.</span><span class="n">optimizationOption</span><span class="p">.</span><span class="n">floatValue</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.0</span><span class="p">;</span><span class="w"> </span><span class="c1">// set to 0 to turn off</span>
<span class="linenos"> 5</span>
<span class="linenos"> 6</span><span class="w"> </span><span class="n">QnnGraph_Config_t</span><span class="w"> </span><span class="n">graphConfig</span><span class="p">;</span>
<span class="linenos"> 7</span><span class="w"> </span><span class="n">graphConfig</span><span class="p">.</span><span class="n">option</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="n">QNN_GRAPH_CONFIG_OPTION_CUSTOM</span><span class="p">;</span>
<span class="linenos"> 8</span><span class="w"> </span><span class="n">graphConfig</span><span class="p">.</span><span class="n">customConfig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">customConfig</span><span class="p">;</span>
<span class="linenos"> 9</span>
<span class="linenos">10</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">QnnGraph_Config_t</span><span class="o">*</span><span class="w"> </span><span class="n">pGraphConfig</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="o">&amp;</span><span class="n">graphConfig</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">};</span>
</pre></div>
</div>
<p>For offline preparation with DLBC, the backend-specific config file should specify the following option along with any other desired options:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">   </span><span class="s">&quot;graphs&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="s">&quot;vtcm_mb&quot;</span><span class="o">:</span><span class="p">...,</span>
<span class="w">     </span><span class="s">&quot;graph_names&quot;</span><span class="o">:</span><span class="p">[...],</span>
<span class="w">     </span><span class="s">&quot;dlbc&quot;</span><span class="o">:</span><span class="w"> </span><span class="mf">1.0</span><span class="w"> </span><span class="c1">// set to 0 to turn off</span>
<span class="w">     </span><span class="p">...</span>
<span class="w">   </span><span class="p">},</span>
<span class="w">   </span><span class="s">&quot;devices&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">      </span><span class="p">{</span>
<span class="w">         </span><span class="p">...</span>
<span class="w">         </span><span class="p">...</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">   </span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Value of 0 will turn OFF the feature and any positive floating point value greater than or equal to 1.0 will turn ON the
feature. By default DLBC will be in disabled state i.e. when configuration option is not provided.</p>
</div>
<div class="section" id="qnn-htp-setting-number-of-hvx-threads">
<h2>QNN HTP - Setting Number of HVX Threads<a class="headerlink" href="#qnn-htp-setting-number-of-hvx-threads" title="Permalink to this headline">¶</a></h2>
<p>This option allows user to set number of HVX thread(s) for a particular graph. The inference
time depends on the number of HVX threads utilized. If more threads are used, the execution
time of a graph will be lower (i.e. faster).</p>
<p>Number of HVX threads can be configured for both online and offline prepare cases. The
value passed in the config during binary blob creation is what gets written in the serialized blob.
Number of HVX threads can be re-configured by passing a new config to <code class="docutils literal notranslate"><span class="pre">QnnGraph_setConfig</span></code> QNN
API.</p>
<p>It is important to note that number of threads <strong>can not</strong> be configured/re-configured
after the first execution of that particular graph; it has to be prior to it.</p>
<p>Users can set the custom option as such:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="w"> </span><span class="n">QnnHtpGraph_CustomConfig_t</span><span class="w"> </span><span class="n">customConfig</span><span class="p">;</span>
<span class="linenos">2</span><span class="w"> </span><span class="n">customConfig</span><span class="p">.</span><span class="n">option</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">QNN_HTP_GRAPH_CONFIG_OPTION_NUM_HVX_THREADS</span><span class="p">;</span>
<span class="linenos">3</span><span class="w"> </span><span class="n">customConfig</span><span class="p">.</span><span class="n">numHvxThreads</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">3</span><span class="p">;</span><span class="w"> </span><span class="c1">// set a number. MAX = number of HVX HW blocks for that SoC</span>
<span class="linenos">4</span>
<span class="linenos">5</span><span class="w"> </span><span class="n">QnnGraph_Config_t</span><span class="w"> </span><span class="n">graphConfig</span><span class="p">;</span>
<span class="linenos">6</span><span class="w"> </span><span class="n">graphConfig</span><span class="p">.</span><span class="n">option</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="n">QNN_GRAPH_CONFIG_OPTION_CUSTOM</span><span class="p">;</span>
<span class="linenos">7</span><span class="w"> </span><span class="n">graphConfig</span><span class="p">.</span><span class="n">customConfig</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">customConfig</span><span class="p">;</span>
<span class="linenos">8</span>
<span class="linenos">9</span><span class="w"> </span><span class="k">const</span><span class="w"> </span><span class="n">QnnGraph_Config_t</span><span class="o">*</span><span class="w"> </span><span class="n">pGraphConfig</span><span class="p">[]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="o">&amp;</span><span class="n">graphConfig</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">};</span>
</pre></div>
</div>
<p>The backend-specific config file should specify the following option along with
any other desired options. In the case of offline prepare, If “hvx_threads” option
is not provided, a default value of 4 is written to the binary blob. In the case of
online prepare, if a config does not set any number of hvx thread(s), max supported
value for that SoC is used during an inference.</p>
<p>Config can be used to set number of HVX threads as such:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">   </span><span class="s">&quot;graphs&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="s">&quot;vtcm_mb&quot;</span><span class="o">:</span><span class="p">...,</span>
<span class="w">     </span><span class="s">&quot;graph_names&quot;</span><span class="o">:</span><span class="p">[...],</span>
<span class="w">     </span><span class="s">&quot;hvx_threads&quot;</span><span class="o">:</span><span class="mi">3</span><span class="w"> </span><span class="c1">// set a number. MAX = number of HVX HW blocks for that SoC</span>
<span class="w">     </span><span class="p">...</span>
<span class="w">   </span><span class="p">},</span>
<span class="w">   </span><span class="s">&quot;devices&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">      </span><span class="p">{</span>
<span class="w">         </span><span class="p">...</span>
<span class="w">         </span><span class="p">...</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">   </span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="section" id="qnn-htp-backend-extensions">
<h2>QNN HTP Backend Extensions<a class="headerlink" href="#qnn-htp-backend-extensions" title="Permalink to this headline">¶</a></h2>
<p>The qnn-net-run utility is backend agnostic, meaning it can only use generic QNN APIs. The backend extension feature
facilitates usage of the backend specific APIs, namely custom configurations. More documentation on backend extensions
can be found under <a class="reference internal" href="../tools.html#qnn-net-run"><span class="std std-ref">qnn-net-run</span></a>. Note that the scope of QNN backend extensions is
limited to qnn-net-run.</p>
<p>Backend Extensions is an interface to provide additional options to HTP Backend. These options can be used with
backend extensions to enable different performance modes which can be exercised using <code class="docutils literal notranslate"><span class="pre">--perf_profile</span></code> option.
This can be done by providing an extension shared library (.so) and a config file, if necessary.</p>
<p>To use backend extension related parameters with qnn-net-run, use <code class="docutils literal notranslate"><span class="pre">--config_file</span></code> argument and give path to JSON file.</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">$</span><span class="w"> </span><span class="n">qnn</span><span class="o">-</span><span class="n">net</span><span class="o">-</span><span class="n">run</span><span class="w"> </span><span class="o">--</span><span class="n">model</span><span class="w"> </span><span class="o">&lt;</span><span class="n">qnn_model_name</span><span class="p">.</span><span class="n">so</span><span class="o">&gt;</span><span class="w"> </span>\
<span class="w">              </span><span class="o">--</span><span class="n">backend</span><span class="w"> </span><span class="o">&lt;</span><span class="n">path_to_model_library</span><span class="o">&gt;/</span><span class="n">libQnnHtp</span><span class="p">.</span><span class="n">so</span><span class="w"> </span>\
<span class="w">              </span><span class="o">--</span><span class="n">output_dir</span><span class="w"> </span><span class="o">&lt;</span><span class="n">output_dir_for_result</span><span class="o">&gt;</span><span class="w"> </span>\
<span class="w">              </span><span class="o">--</span><span class="n">input_list</span><span class="w"> </span><span class="o">&lt;</span><span class="n">path_to_input_list</span><span class="p">.</span><span class="n">txt</span><span class="o">&gt;</span>
<span class="w">              </span><span class="o">--</span><span class="n">config_file</span><span class="w"> </span><span class="o">&lt;</span><span class="n">path</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">JSON</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">backend</span><span class="w"> </span><span class="n">extensions</span><span class="o">&gt;</span>
</pre></div>
</div>
<p>The above config file with minimum parameters specified through JSON is given below:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="s">&quot;backend_extensions&quot;</span><span class="w"> </span><span class="o">:</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">        </span><span class="s">&quot;shared_library_path&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;path_to_shared_library&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s">&quot;config_file_path&quot;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="s">&quot;path_to_config_file&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>HTP Backend supports extensions shared library(.so) through <code class="docutils literal notranslate"><span class="pre">libQnnHtpNetRunExtensions.so</span></code> shared library. User can set specific
parameters related to graphs, devices and CDSP core through config json file. Along with the shared library user can pass config json file
for setting specific parameters shown below:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">  </span><span class="s">&quot;graphs&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="s">&quot;type&quot;</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;object&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;properties&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// Provides performance infrastructure configuration options that are memory specific [optional]</span>
<span class="w">      </span><span class="c1">// Used by qnn-net-run during online prepare and qnn-context-binary-generator uses it during offline preparation</span>
<span class="w">      </span><span class="s">&quot;vtcm_mb&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;type&quot;</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;integer&quot;</span><span class="p">},</span>

<span class="w">      </span><span class="c1">// Used to perform computation with half precision i.e. 16 bits [optional] [default: false]</span>
<span class="w">      </span><span class="c1">// Used by qnn-net-run during online prepare and qnn-context-binary-generator uses it during offline preparation</span>
<span class="w">      </span><span class="s">&quot;fp16_relaxed_precision&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;type&quot;</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;boolean&quot;</span><span class="p">},</span>

<span class="w">      </span><span class="c1">// Corresponds to the graph name provided to QnnGraph_create</span>
<span class="w">      </span><span class="c1">// Used by qnn-net-run during online prepare and qnn-context-binary-generator uses it during offline preparation</span>
<span class="w">      </span><span class="s">&quot;graph_names&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;type&quot;</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;array&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;items&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;type&quot;</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;string&quot;</span><span class="p">}},</span>

<span class="w">      </span><span class="c1">// Set Graph optimization value in range 1 to 3 [optional] [default: 2]</span>
<span class="w">      </span><span class="c1">// 1 = Faster preparation time, less optimal graph, 2 = Longer preparation time, more optimal graph</span>
<span class="w">      </span><span class="c1">// 3 = Longest preparation time, most likely even more optimal graph</span>
<span class="w">      </span><span class="c1">// Used by qnn-net-run during online prepare and qnn-context-binary-generator uses it during offline preparation</span>
<span class="w">      </span><span class="s">&quot;O&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;type&quot;</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;integer&quot;</span><span class="p">},</span>

<span class="w">      </span><span class="c1">// Provide deep learning bandwidth compression value 0 or 1 [optional] [default: 0]</span>
<span class="w">      </span><span class="c1">// Used by qnn-net-run during online prepare and qnn-context-binary-generator uses it during offline preparation</span>
<span class="w">      </span><span class="s">&quot;dlbc&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;type&quot;</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;integer&quot;</span><span class="p">},</span>

<span class="w">      </span><span class="c1">// Corresponds to the number of HVX threads to use for a particular graph during an inference.</span>
<span class="w">      </span><span class="c1">// Used by qnn-net-run during online prepare and qnn-context-binary-generator uses it during offline preparation</span>
<span class="w">      </span><span class="s">&quot;hvx_threads&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;type&quot;</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;integer&quot;</span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="s">&quot;devices&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;type&quot;</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;array&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;items&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="c1">// Selection of the device [optional] [default: 0]</span>
<span class="w">      </span><span class="c1">// Used by qnn-net-run and qnn-context-binary-generator</span>
<span class="w">      </span><span class="s">&quot;device_id&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;type&quot;</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;integer&quot;</span><span class="p">},</span>

<span class="w">      </span><span class="c1">// Selection of the SoC [optional] [default: 0]</span>
<span class="w">      </span><span class="c1">// Used by qnn-net-run and qnn-context-binary-generator</span>
<span class="w">      </span><span class="s">&quot;soc_id&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;type&quot;</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;integer&quot;</span><span class="p">},</span>

<span class="w">      </span><span class="c1">// Set dsp architecture value [optional] [default: NONE]</span>
<span class="w">      </span><span class="c1">// Used by qnn-net-run and qnn-context-binary-generator</span>
<span class="w">      </span><span class="s">&quot;dsp_arch&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;type&quot;</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;string&quot;</span><span class="p">},</span>

<span class="w">      </span><span class="c1">// Specifies the user pd attribute [optional] [default: &quot;unsigned&quot;]</span>
<span class="w">      </span><span class="c1">// Used by qnn-net-run and qnn-context-binary-generator</span>
<span class="w">      </span><span class="s">&quot;pd_session&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;type&quot;</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;string&quot;</span><span class="p">},</span>

<span class="w">      </span><span class="c1">// Used for linting profiling level [optional] [default: not set]</span>
<span class="w">      </span><span class="c1">// Used by qnn-net-run and qnn-context-binary-generator</span>
<span class="w">      </span><span class="s">&quot;profiling_level&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;type&quot;</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;string&quot;</span><span class="p">},</span>

<span class="w">      </span><span class="c1">// Specifies whether to use null context or not. true means using a unique power context id, and false means using null context.</span>
<span class="w">      </span><span class="c1">// NOTE: This parameter is not supported for v68 onwards</span>
<span class="w">      </span><span class="c1">// Used by qnn-net-run</span>
<span class="w">      </span><span class="s">&quot;use_client_context&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;type&quot;</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;boolean&quot;</span><span class="p">},</span>

<span class="w">      </span><span class="s">&quot;cores&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;type&quot;</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;array&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;items&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="c1">// Select the core [optional] [default: 0]</span>
<span class="w">          </span><span class="c1">// Used by qnn-net-run and qnn-context-binary-generator</span>
<span class="w">          </span><span class="s">&quot;core_id&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;type&quot;</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;integer&quot;</span><span class="p">},</span>

<span class="w">          </span><span class="c1">// Provide performance profile [optional] [default: &quot;high_performance&quot;]</span>
<span class="w">          </span><span class="c1">// Used by qnn-net-run</span>
<span class="w">          </span><span class="c1">// NOTE: command line perf profile option is now deprecated.</span>
<span class="w">          </span><span class="s">&quot;perf_profile&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;type&quot;</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;string&quot;</span><span class="p">},</span>

<span class="w">          </span><span class="c1">// Rpc control latency value in micro second [optional] [default: 100us]</span>
<span class="w">          </span><span class="c1">// Used by qnn-net-run</span>
<span class="w">          </span><span class="s">&quot;rpc_control_latency&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;type&quot;</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;integer&quot;</span><span class="p">},</span>

<span class="w">          </span><span class="c1">// Rpc polling time value in micro second [optional]</span>
<span class="w">          </span><span class="c1">// [default: 9999 us for burst, high_performance &amp; sustained_high_performance, 0 us for other perf profiles]</span>
<span class="w">          </span><span class="c1">// Used by qnn-net-run</span>
<span class="w">          </span><span class="s">&quot;rpc_polling_time&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;type&quot;</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;integer&quot;</span><span class="p">},</span>

<span class="w">          </span><span class="c1">// Hmx timeout value in micro second [optional] [default: 300000us]</span>
<span class="w">          </span><span class="c1">// Used by qnn-net-run</span>
<span class="w">          </span><span class="s">&quot;hmx_timeout_us&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span><span class="s">&quot;type&quot;</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;integer&quot;</span><span class="p">}}</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Check <a class="reference internal" href="../../api-rst/enum_QnnTypes_8h_1aea3262897ad2f237f9e5189419ad2214.html#exhale-enum-qnntypes-8h-1aea3262897ad2f237f9e5189419ad2214"><span class="std std-ref">Qnn_SocModel_t</span></a> for setting soc_id parameter</p>
<div class="section" id="performance-modes-with-htp-backend-extensions">
<h3>Performance modes with HTP Backend Extensions<a class="headerlink" href="#performance-modes-with-htp-backend-extensions" title="Permalink to this headline">¶</a></h3>
<p>Backend extensions performance modes can be enabled using <code class="docutils literal notranslate"><span class="pre">--perf_profile</span></code> option. Valid settings are low_balanced,
balanced, default, high_performance, sustained_high_performance, burst, low_power_saver, power_saver, high_power_saver, extreme_power_saver
and system_settings. These performance modes use different configurations of core clocks, bus clocks, Dcvs and sleep latency.
There are 3 types of voltage corners defined as TURBO, NOM and SVS which have different min and max frequency thresholds.
Apart from there are MAX and MIN voltage corners which sets the frequency to maximum and minimum frequency supported on target.
For further details on the performance modes configuration and parameter details, refer <em>hexagon sdk</em> documentation.
These settings used by different performance modes are shown in table below:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
<col style="width: 10%" />
</colgroup>
<tbody>
<tr class="row-odd"><td></td>
<td><p><strong>BURST</strong></p></td>
<td><p><strong>SUSTAINED_HIGH_PERFORMANCE</strong></p></td>
<td><p><strong>HIGH_PERFORMANCE</strong></p></td>
<td><p><strong>BALANCED</strong></p></td>
<td><p><strong>LOW_BALANCED</strong></p></td>
<td><p><strong>HIGH_POWER_SAVER</strong></p></td>
<td><p><strong>POWER_SAVER</strong></p></td>
<td><p><strong>LOW_POWER_SAVER</strong></p></td>
<td><p><strong>EXTREME_POWER_SAVER</strong></p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">sleepLatency</span></code></p></td>
<td><p>40 us</p></td>
<td><p>100 us</p></td>
<td><p>100 us</p></td>
<td><p>1000 us</p></td>
<td><p>1000 us</p></td>
<td><p>1000 us</p></td>
<td><p>1000 us</p></td>
<td><p>1000 us</p></td>
<td><p>1000 us</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">dcvsEnable</span></code></p></td>
<td><p>False</p></td>
<td><p>False</p></td>
<td><p>False</p></td>
<td><p>True</p></td>
<td><p>True</p></td>
<td><p>True</p></td>
<td><p>True</p></td>
<td><p>True</p></td>
<td><p>True</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">RPC</span> <span class="pre">Polling</span></code></p></td>
<td><p>ON</p></td>
<td><p>ON</p></td>
<td><p>ON</p></td>
<td><p>OFF</p></td>
<td><p>OFF</p></td>
<td><p>OFF</p></td>
<td><p>OFF</p></td>
<td><p>OFF</p></td>
<td><p>OFF</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">busVCornerMin</span></code></p></td>
<td><p>MAX_VOLTAGE_CORNER</p></td>
<td><p>TURBO</p></td>
<td><p>TURBO</p></td>
<td><p>NOM_PLUS</p></td>
<td><p>NOM</p></td>
<td><p>SVS_PLUS</p></td>
<td><p>SVS</p></td>
<td><p>SVS2</p></td>
<td><p>DISABLE</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">busVCornerTarget</span></code></p></td>
<td><p>MAX_VOLTAGE_CORNER</p></td>
<td><p>TURBO</p></td>
<td><p>TURBO</p></td>
<td><p>NOM_PLUS</p></td>
<td><p>NOM</p></td>
<td><p>SVS_PLUS</p></td>
<td><p>SVS</p></td>
<td><p>SVS2</p></td>
<td><p>DISABLE</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">busVCornerMax</span></code></p></td>
<td><p>MAX_VOLTAGE_CORNER</p></td>
<td><p>TURBO</p></td>
<td><p>TURBO</p></td>
<td><p>NOM_PLUS</p></td>
<td><p>NOM</p></td>
<td><p>SVS_PLUS</p></td>
<td><p>SVS</p></td>
<td><p>SVS2</p></td>
<td><p>DISABLE</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">coreVCornerMin</span></code></p></td>
<td><p>MAX_VOLTAGE_CORNER</p></td>
<td><p>TURBO</p></td>
<td><p>TURBO</p></td>
<td><p>NOM_PLUS</p></td>
<td><p>NOM</p></td>
<td><p>SVS_PLUS</p></td>
<td><p>SVS</p></td>
<td><p>SVS2</p></td>
<td><p>DISABLE</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">coreVCornerTarget</span></code></p></td>
<td><p>MAX_VOLTAGE_CORNER</p></td>
<td><p>TURBO</p></td>
<td><p>TURBO</p></td>
<td><p>NOM_PLUS</p></td>
<td><p>NOM</p></td>
<td><p>SVS_PLUS</p></td>
<td><p>SVS</p></td>
<td><p>SVS2</p></td>
<td><p>DISABLE</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">coreVCornerMax</span></code></p></td>
<td><p>MAX_VOLTAGE_CORNER</p></td>
<td><p>TURBO</p></td>
<td><p>TURBO</p></td>
<td><p>NOM_PLUS</p></td>
<td><p>NOM</p></td>
<td><p>SVS_PLUS</p></td>
<td><p>SVS</p></td>
<td><p>SVS2</p></td>
<td><p>DISABLE</p></td>
</tr>
</tbody>
</table>
<p>Above table is ordered from highest performance (BURST) to lowest performance (EXTREME_POWER_SAVER).
BURST and SUSTAINED_HIGH_PERFORMANCE uses a timer during execution which helps in keeping the vote high for all inferences and avoids
subsequent up-down perf votes until timeout. They have low sleep latency and disables the DCVS during execution. DCVS can both increase
and decrease the core/bus clock speeds while min_corner and max_corner votes are used as lower and upper limit guidelines.
BURST has the highest frequency and it sustains high voting, which gives the best performance. POWER_SAVER, LOW_POWER_SAVER and
HIGH_POWER_SAVER has low frequency and does not sustain vote. They have high sleep latency and enables DCVS during execution.
EXTREME_POWER_SAVER is the lowest performing performance mode and saves the highest power. For further details on the performance modes
and the voltage corners used by these refer
<a class="reference internal" href="../../api-rst/program_listing_file_include_QNN_HTP_QnnHtpPerfInfrastructure.h.html#program-listing-file-include-qnn-htp-qnnhtpperfinfrastructure-h"><span class="std std-ref">Program Listing for File QnnHtpPerfInfrastructure.h</span></a></p>
<p>Below config can be used to set performance profile and rpc polling time:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">   </span><span class="s">&quot;graphs&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">       </span><span class="p">...</span>
<span class="w">       </span><span class="p">...</span>
<span class="w">   </span><span class="p">},</span>
<span class="w">   </span><span class="s">&quot;devices&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">      </span><span class="p">{</span>
<span class="w">         </span><span class="p">...</span>
<span class="w">         </span><span class="s">&quot;cores&quot;</span><span class="o">:</span><span class="p">[</span>
<span class="w">            </span><span class="p">{</span>
<span class="w">                </span><span class="s">&quot;perf_profile&quot;</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;burst&quot;</span><span class="p">,</span><span class="w">    </span><span class="c1">// use this to set any of the above performance profile</span>
<span class="w">                </span><span class="s">&quot;rpc_polling_time&quot;</span><span class="o">:</span><span class="w"> </span><span class="mi">9999</span><span class="w">    </span><span class="c1">// use this to set rpc polling, ranges 0-9999 us</span>
<span class="w">                </span><span class="s">&quot;rpc_control_latency&quot;</span><span class="o">:</span><span class="w"> </span><span class="mi">100</span><span class="w">  </span><span class="c1">// use to set rpc control latency</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">         </span><span class="p">]</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">   </span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="qnn-htp-profiling">
<h2>QNN HTP Profiling<a class="headerlink" href="#qnn-htp-profiling" title="Permalink to this headline">¶</a></h2>
<p>Detailed profiling report provides per op profiling result by cycle counts instead of time in microsecs.
There is no direct conversion method from cycle count to microsecs because of the parallelized execution
of Ops. Hence it is recommended to use the per layer cycle timings as a reference to compare/measure the
relative performance to know which of them are using lower/higher cycles to finish the execution.</p>
<p>HTP-specific linting profiling report provides per op cycle count on the main thread along with background
execution information. On the main thread, each op has to wait for some cycles since the execution of the
last op before the start of its own execution. This wait period can be attributed to various factors such as
scheduling or waiting for some background HVX or DMA activity to finish. In linting profiling report, each
op has a cycle count associated with it signifying the amount of cycles spent actually executing the op on
the main thread. There is also a “Wait” entry associated with each op that correponds to the wait period
mentioned before. Aside from these two cycle counts that describe the main thread activity, each op has two
more entries to depict background activity. The first of these two entries is the “Overlap” entry denoting
the number of cycles spent on at least one background op while the op is executing on the main thread. Next,
each op has a “Overlap (wait)” entry that is similar to the “Wait” entry with the exception that the cycles
reported in this entry correspond to the “Wait” period (ie. cycles spent on at least one background op while
the main thread was waiting). Background ops that are being waited on by main thread ops are not considered
as background activity and as such do not contribute to the counts reported by the overlap entries. Each of
the overlap entries also has several indented lines (10 maximum) following it indicating the names of the ops
that contributed to the respective overlap cycle count. Finally, each op also has a “Resources” entry listing
the different resources used by that op.
The HTP-specific linting profiling level can be enabled by specifying <code class="code docutils literal notranslate"><span class="pre">--profiling_level=backend</span></code> when
running qnn-net-run so that the profiling level specified in the backend-specific config file is used. Please
refer to the documentation for qnn-net-run to learn more about libQnnHtpNetRunExtensions.so and backend-specific
config files. For linting profiling, the backend-specific config file should specify the following option along
with any other desired option:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">   </span><span class="s">&quot;graphs&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="p">...</span>
<span class="w">   </span><span class="p">},</span>
<span class="w">   </span><span class="s">&quot;devices&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">      </span><span class="p">{</span>
<span class="w">         </span><span class="p">...</span>
<span class="w">         </span><span class="s">&quot;profiling_level&quot;</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;linting&quot;</span><span class="p">,</span>
<span class="w">         </span><span class="p">...</span>
<span class="w">         </span><span class="s">&quot;cores&quot;</span><span class="o">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">            </span><span class="p">{</span>
<span class="w">               </span><span class="p">...</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">         </span><span class="p">]</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">   </span><span class="p">]</span>
<span class="p">}</span>
</pre></div>
</div>
<p>The profile outputs generated with this profiling level can be viewed using the qnn-profile-viewer tool with its
libQnnHtpProfilingReader.so or libQnnChrometraceProfilingReader.so reader plugin. libQnnHtpProfilingReader.so
reader provides raw output of every single run whereas libQnnChrometraceProfilingReader.so provides average
output of all the runs. Additionally, a file containing the profiling data in chrometrace format can be generated
if an output file is specified with the <code class="code docutils literal notranslate"><span class="pre">--output</span></code> option when running the qnn-profile-viewer tool with the
libQnnChrometraceProfilingReader.so reader plugin.</p>
<p><a class="reference internal" href="#qnn-htp-profiling-showcase-model-original1-figure"><span class="std std-ref">Showcase Model 1</span></a> diagram illustrates a model with two
branches each performing a couple of convolutions before their results are used in a sub operation.</p>
<p class="centered" id="qnn-htp-profiling-showcase-model-original1-figure">
<strong><strong>Showcase Model 1</strong></strong></p><div class="figure align-center">
<img alt="QNN HTP Profiling Showcase Model 1" src="../../_static/resources/qnn_htp_profiling_showcase_model_original_1.png" />
</div>
<p>The linting profiling output for this model is given below:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">Execute</span><span class="w"> </span><span class="n">Stats</span><span class="w"> </span><span class="p">(</span><span class="n">Average</span><span class="p">)</span><span class="o">:</span>
<span class="o">------------------------</span>
<span class="n">Total</span><span class="w"> </span><span class="n">Inference</span><span class="w"> </span><span class="n">Time</span><span class="o">:</span>
<span class="o">---------------------</span>
<span class="w">   </span><span class="nl">NetRun</span><span class="p">:</span><span class="w">  </span><span class="mi">16792</span><span class="w"> </span><span class="n">us</span>
<span class="w">   </span><span class="n">Backend</span><span class="w"> </span><span class="p">(</span><span class="n">RPC</span><span class="w"> </span><span class="p">(</span><span class="n">execute</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">16242</span><span class="w">  </span><span class="n">us</span>
<span class="w">   </span><span class="n">Backend</span><span class="w"> </span><span class="p">(</span><span class="n">QNN</span><span class="w"> </span><span class="n">accelerator</span><span class="w"> </span><span class="p">(</span><span class="n">execute</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">15190</span><span class="w">  </span><span class="n">us</span>
<span class="w">   </span><span class="n">Backend</span><span class="w"> </span><span class="p">(</span><span class="n">Num</span><span class="w"> </span><span class="n">times</span><span class="w"> </span><span class="n">yield</span><span class="w"> </span><span class="n">occured</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">count</span>
<span class="w">   </span><span class="n">Backend</span><span class="w"> </span><span class="p">(</span><span class="n">Time</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">initial</span><span class="w"> </span><span class="n">VTCM</span><span class="w"> </span><span class="n">acquire</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">us</span>
<span class="w">   </span><span class="n">Backend</span><span class="w"> </span><span class="p">(</span><span class="n">Time</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">HVX</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">HMX</span><span class="w"> </span><span class="n">power</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">acquire</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">us</span>
<span class="w">   </span><span class="n">Backend</span><span class="w"> </span><span class="p">(</span><span class="n">Accelerator</span><span class="w"> </span><span class="p">(</span><span class="n">critical</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="n">execute</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="p">(</span><span class="n">cycles</span><span class="p">))</span><span class="o">:</span><span class="w"> </span><span class="mi">4327266</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">      </span><span class="n">Input</span><span class="w"> </span><span class="n">OpId_2</span><span class="w"> </span><span class="p">(</span><span class="n">cycles</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Wait</span><span class="w"> </span><span class="p">(</span><span class="n">Scheduler</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="p">(</span><span class="n">wait</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="nl">Resources</span><span class="p">:</span>
<span class="w">      </span><span class="n">OpId_0</span><span class="w"> </span><span class="p">(</span><span class="n">cycles</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">8036</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Wait</span><span class="w"> </span><span class="p">(</span><span class="n">Scheduler</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">629</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">4770</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="p">(</span><span class="n">wait</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">565</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="nl">Resources</span><span class="p">:</span>
<span class="w">      </span><span class="nl">model_convStart_Conv2D</span><span class="p">:</span><span class="n">OpId_21</span><span class="w"> </span><span class="p">(</span><span class="n">cycles</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">147075</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Wait</span><span class="w"> </span><span class="p">(</span><span class="n">Scheduler</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">32</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">85292</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">               </span><span class="nl">model_sub_sub</span><span class="p">:</span><span class="n">OpId_57</span>
<span class="w">               </span><span class="n">Output</span><span class="w"> </span><span class="n">OpId_3</span>
<span class="w">               </span><span class="nl">model_add_add</span><span class="p">:</span><span class="n">OpId_58</span>
<span class="w">               </span><span class="nl">model_tf_op_layer_stride_stride</span><span class="p">:</span><span class="n">OpId_24</span>
<span class="w">               </span><span class="nl">model_convStart_Conv2D</span><span class="p">:</span><span class="n">OpId_21</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="p">(</span><span class="n">wait</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">32</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">               </span><span class="nl">model_convStart_Conv2D</span><span class="p">:</span><span class="n">OpId_21</span>
<span class="w">            </span><span class="nl">Resources</span><span class="p">:</span><span class="w"> </span><span class="n">HVX</span><span class="p">,</span><span class="w"> </span><span class="n">HMX</span><span class="p">,</span><span class="w"> </span><span class="n">DMA</span>
<span class="w">      </span><span class="nl">model_tf_op_layer_stride_stride</span><span class="p">:</span><span class="n">OpId_24</span><span class="w"> </span><span class="p">(</span><span class="n">cycles</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">146494</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Wait</span><span class="w"> </span><span class="p">(</span><span class="n">Scheduler</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">70807</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">               </span><span class="nl">model_add_add</span><span class="p">:</span><span class="n">OpId_58</span>
<span class="w">               </span><span class="n">Output</span><span class="w"> </span><span class="n">OpId_3</span>
<span class="w">               </span><span class="nl">model_convStart_Conv2D</span><span class="p">:</span><span class="n">OpId_21</span>
<span class="w">               </span><span class="nl">model_tf_op_layer_stride_stride</span><span class="p">:</span><span class="n">OpId_24</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="p">(</span><span class="n">wait</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="nl">Resources</span><span class="p">:</span><span class="w"> </span><span class="n">HVX</span>
<span class="w">      </span><span class="nl">model_convLeft1_Conv2D</span><span class="p">:</span><span class="n">OpId_34</span><span class="w"> </span><span class="p">(</span><span class="n">cycles</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">288249</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Wait</span><span class="w"> </span><span class="p">(</span><span class="n">Scheduler</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">425</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">195988</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">               </span><span class="n">Output</span><span class="w"> </span><span class="n">OpId_3</span>
<span class="w">               </span><span class="nl">model_add_add</span><span class="p">:</span><span class="n">OpId_58</span>
<span class="w">               </span><span class="nl">model_tf_op_layer_stride_stride</span><span class="p">:</span><span class="n">OpId_24</span>
<span class="w">               </span><span class="nl">model_convStart_Conv2D</span><span class="p">:</span><span class="n">OpId_21</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="p">(</span><span class="n">wait</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">304</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">               </span><span class="n">Output</span><span class="w"> </span><span class="n">OpId_3</span>
<span class="w">               </span><span class="nl">model_add_add</span><span class="p">:</span><span class="n">OpId_58</span>
<span class="w">               </span><span class="nl">model_convStart_Conv2D</span><span class="p">:</span><span class="n">OpId_21</span>
<span class="w">            </span><span class="nl">Resources</span><span class="p">:</span><span class="w"> </span><span class="n">HMX</span><span class="p">,</span><span class="w"> </span><span class="n">DMA</span>
<span class="w">      </span><span class="nl">model_convRight1_Conv2D</span><span class="p">:</span><span class="n">OpId_41</span><span class="w"> </span><span class="p">(</span><span class="n">cycles</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">220391</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Wait</span><span class="w"> </span><span class="p">(</span><span class="n">Scheduler</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">803</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">135268</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">               </span><span class="n">Output</span><span class="w"> </span><span class="n">OpId_3</span>
<span class="w">               </span><span class="nl">model_add_add</span><span class="p">:</span><span class="n">OpId_58</span>
<span class="w">               </span><span class="nl">model_tf_op_layer_stride_stride</span><span class="p">:</span><span class="n">OpId_24</span>
<span class="w">               </span><span class="nl">model_convStart_Conv2D</span><span class="p">:</span><span class="n">OpId_21</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="p">(</span><span class="n">wait</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">557</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">               </span><span class="n">Output</span><span class="w"> </span><span class="n">OpId_3</span>
<span class="w">               </span><span class="nl">model_tf_op_layer_stride_stride</span><span class="p">:</span><span class="n">OpId_24</span>
<span class="w">               </span><span class="nl">model_convStart_Conv2D</span><span class="p">:</span><span class="n">OpId_21</span>
<span class="w">            </span><span class="nl">Resources</span><span class="p">:</span><span class="w"> </span><span class="n">HMX</span><span class="p">,</span><span class="w"> </span><span class="n">DMA</span>
<span class="w">      </span><span class="nl">model_convRight2_Conv2D</span><span class="p">:</span><span class="n">OpId_48</span><span class="w"> </span><span class="p">(</span><span class="n">cycles</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">181016</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Wait</span><span class="w"> </span><span class="p">(</span><span class="n">Scheduler</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">1090</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">69323</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">               </span><span class="nl">model_sub_sub</span><span class="p">:</span><span class="n">OpId_57</span>
<span class="w">               </span><span class="nl">model_convStart_Conv2D</span><span class="p">:</span><span class="n">OpId_21</span>
<span class="w">               </span><span class="n">Output</span><span class="w"> </span><span class="n">OpId_3</span>
<span class="w">               </span><span class="nl">model_add_add</span><span class="p">:</span><span class="n">OpId_58</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="p">(</span><span class="n">wait</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">489</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">               </span><span class="nl">model_sub_sub</span><span class="p">:</span><span class="n">OpId_57</span>
<span class="w">               </span><span class="nl">model_convStart_Conv2D</span><span class="p">:</span><span class="n">OpId_21</span>
<span class="w">               </span><span class="n">Output</span><span class="w"> </span><span class="n">OpId_3</span>
<span class="w">               </span><span class="nl">model_add_add</span><span class="p">:</span><span class="n">OpId_58</span>
<span class="w">            </span><span class="nl">Resources</span><span class="p">:</span><span class="w"> </span><span class="n">HMX</span><span class="p">,</span><span class="w"> </span><span class="n">DMA</span>
<span class="w">      </span><span class="nl">model_convLeft2_Conv2D</span><span class="p">:</span><span class="n">OpId_55</span><span class="w"> </span><span class="p">(</span><span class="n">cycles</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">233736</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Wait</span><span class="w"> </span><span class="p">(</span><span class="n">Scheduler</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">1059</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">93020</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">               </span><span class="nl">model_sub_sub</span><span class="p">:</span><span class="n">OpId_57</span>
<span class="w">               </span><span class="nl">model_convStart_Conv2D</span><span class="p">:</span><span class="n">OpId_21</span>
<span class="w">               </span><span class="n">Output</span><span class="w"> </span><span class="n">OpId_3</span>
<span class="w">               </span><span class="nl">model_add_add</span><span class="p">:</span><span class="n">OpId_58</span>
<span class="w">               </span><span class="nl">model_tf_op_layer_stride_stride</span><span class="p">:</span><span class="n">OpId_24</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="p">(</span><span class="n">wait</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">464</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">               </span><span class="nl">model_sub_sub</span><span class="p">:</span><span class="n">OpId_57</span>
<span class="w">               </span><span class="nl">model_convStart_Conv2D</span><span class="p">:</span><span class="n">OpId_21</span>
<span class="w">               </span><span class="n">Output</span><span class="w"> </span><span class="n">OpId_3</span>
<span class="w">               </span><span class="nl">model_add_add</span><span class="p">:</span><span class="n">OpId_58</span>
<span class="w">            </span><span class="nl">Resources</span><span class="p">:</span><span class="w"> </span><span class="n">HMX</span><span class="p">,</span><span class="w"> </span><span class="n">DMA</span>
<span class="w">      </span><span class="nl">model_sub_sub</span><span class="p">:</span><span class="n">OpId_57</span><span class="w"> </span><span class="p">(</span><span class="n">cycles</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">2165162</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Wait</span><span class="w"> </span><span class="p">(</span><span class="n">Scheduler</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">465046</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">               </span><span class="nl">model_sub_sub</span><span class="p">:</span><span class="n">OpId_57</span>
<span class="w">               </span><span class="n">Output</span><span class="w"> </span><span class="n">OpId_3</span>
<span class="w">               </span><span class="nl">model_add_add</span><span class="p">:</span><span class="n">OpId_58</span>
<span class="w">               </span><span class="nl">model_convStart_Conv2D</span><span class="p">:</span><span class="n">OpId_21</span>
<span class="w">               </span><span class="nl">model_tf_op_layer_stride_stride</span><span class="p">:</span><span class="n">OpId_24</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="p">(</span><span class="n">wait</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="nl">Resources</span><span class="p">:</span><span class="w"> </span><span class="n">HVX</span>
<span class="w">      </span><span class="nl">model_add_add</span><span class="p">:</span><span class="n">OpId_58</span><span class="w"> </span><span class="p">(</span><span class="n">cycles</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">525971</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Wait</span><span class="w"> </span><span class="p">(</span><span class="n">Scheduler</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">481468</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">               </span><span class="nl">model_tf_op_layer_stride_stride</span><span class="p">:</span><span class="n">OpId_24</span>
<span class="w">               </span><span class="nl">model_convStart_Conv2D</span><span class="p">:</span><span class="n">OpId_21</span>
<span class="w">               </span><span class="n">Output</span><span class="w"> </span><span class="n">OpId_3</span>
<span class="w">               </span><span class="nl">model_add_add</span><span class="p">:</span><span class="n">OpId_58</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="p">(</span><span class="n">wait</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="nl">Resources</span><span class="p">:</span><span class="w"> </span><span class="n">HVX</span>
<span class="w">      </span><span class="n">Output</span><span class="w"> </span><span class="n">OpId_3</span><span class="w"> </span><span class="p">(</span><span class="n">cycles</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">407091</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Wait</span><span class="w"> </span><span class="p">(</span><span class="n">Scheduler</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">115120</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="p">(</span><span class="n">wait</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="nl">Resources</span><span class="p">:</span><span class="w"> </span><span class="n">HVX</span>
</pre></div>
</div>
<p>The linting profiling chrometrace output for this model is given below:</p>
<p class="centered" id="qnn-htp-profiling-showcase-model-original1-chrometrace-figure">
<strong><strong>Showcase Model 1 Chrometrace</strong></strong></p><div class="figure align-center">
<img alt="QNN HTP Profiling Showcase Model 1 Chrometrace" src="../../_static/resources/qnn_htp_profiling_showcase_model_original_1_chrometrace.png" />
</div>
<p>From the output, it is evident that the sub op (OpId_57) is the most significant contributor
to the total execution time - around 50%. This op also does not have significant parallel op
execution - its Overlap time is 465046 cycles which is about 21.5% of its total execution time -
indicating that this op is a good bottleneck to optimize. We can design an equvalent model as
shown in the <a class="reference internal" href="#qnn-htp-profiling-showcase-model-optimized1-figure"><span class="std std-ref">Showcase Model 1 Optimized</span></a>
diagram merging the two branches and replacing the sub op with a convolution with weights manually
designed such that it performs the same task as a sub op.</p>
<p class="centered" id="qnn-htp-profiling-showcase-model-optimized1-figure">
<strong><strong>Showcase Model 1 Optimized</strong></strong></p><div class="figure align-center">
<img alt="QNN HTP Profiling Showcase Model 1 Optimized" src="../../_static/resources/qnn_htp_profiling_showcase_model_optimized_1.png" />
</div>
<p>The linting profiling output for this optimized model is given below:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">Execute</span><span class="w"> </span><span class="n">Stats</span><span class="w"> </span><span class="p">(</span><span class="n">Average</span><span class="p">)</span><span class="o">:</span>
<span class="o">------------------------</span>
<span class="n">Total</span><span class="w"> </span><span class="n">Inference</span><span class="w"> </span><span class="n">Time</span><span class="o">:</span>
<span class="o">---------------------</span>
<span class="w">   </span><span class="nl">NetRun</span><span class="p">:</span><span class="w">  </span><span class="mi">11884</span><span class="w"> </span><span class="n">us</span>
<span class="w">   </span><span class="n">Backend</span><span class="w"> </span><span class="p">(</span><span class="n">RPC</span><span class="w"> </span><span class="p">(</span><span class="n">execute</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">11525</span><span class="w">  </span><span class="n">us</span>
<span class="w">   </span><span class="n">Backend</span><span class="w"> </span><span class="p">(</span><span class="n">QNN</span><span class="w"> </span><span class="n">accelerator</span><span class="w"> </span><span class="p">(</span><span class="n">execute</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">10481</span><span class="w">  </span><span class="n">us</span>
<span class="w">   </span><span class="n">Backend</span><span class="w"> </span><span class="p">(</span><span class="n">Num</span><span class="w"> </span><span class="n">times</span><span class="w"> </span><span class="n">yield</span><span class="w"> </span><span class="n">occured</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">count</span>
<span class="w">   </span><span class="n">Backend</span><span class="w"> </span><span class="p">(</span><span class="n">Time</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">initial</span><span class="w"> </span><span class="n">VTCM</span><span class="w"> </span><span class="n">acquire</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">us</span>
<span class="w">   </span><span class="n">Backend</span><span class="w"> </span><span class="p">(</span><span class="n">Time</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">HVX</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">HMX</span><span class="w"> </span><span class="n">power</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">acquire</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">us</span>
<span class="w">   </span><span class="n">Backend</span><span class="w"> </span><span class="p">(</span><span class="n">Accelerator</span><span class="w"> </span><span class="p">(</span><span class="n">critical</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="n">execute</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="p">(</span><span class="n">cycles</span><span class="p">))</span><span class="o">:</span><span class="w"> </span><span class="mi">1374349</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">      </span><span class="n">Input</span><span class="w"> </span><span class="n">OpId_2</span><span class="w"> </span><span class="p">(</span><span class="n">cycles</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Wait</span><span class="w"> </span><span class="p">(</span><span class="n">Scheduler</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="p">(</span><span class="n">wait</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="nl">Resources</span><span class="p">:</span>
<span class="w">      </span><span class="n">OpId_0</span><span class="w"> </span><span class="p">(</span><span class="n">cycles</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">3500</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Wait</span><span class="w"> </span><span class="p">(</span><span class="n">Scheduler</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">1284</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">3221</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="p">(</span><span class="n">wait</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">1268</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="nl">Resources</span><span class="p">:</span>
<span class="w">      </span><span class="nl">model_convStart_Conv2D</span><span class="p">:</span><span class="n">OpId_21</span><span class="w"> </span><span class="p">(</span><span class="n">cycles</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">487448</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Wait</span><span class="w"> </span><span class="p">(</span><span class="n">Scheduler</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">32</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">475888</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">               </span><span class="n">Output</span><span class="w"> </span><span class="n">OpId_3</span>
<span class="w">               </span><span class="nl">model_add_add</span><span class="p">:</span><span class="n">OpId_50</span>
<span class="w">               </span><span class="nl">model_tf_op_layer_stride_1_stride_1</span><span class="p">:</span><span class="n">OpId_24</span>
<span class="w">               </span><span class="nl">model_convStart_Conv2D</span><span class="p">:</span><span class="n">OpId_21</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="p">(</span><span class="n">wait</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">32</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">               </span><span class="nl">model_convStart_Conv2D</span><span class="p">:</span><span class="n">OpId_21</span>
<span class="w">            </span><span class="nl">Resources</span><span class="p">:</span><span class="w"> </span><span class="n">HVX</span><span class="p">,</span><span class="w"> </span><span class="n">HMX</span><span class="p">,</span><span class="w"> </span><span class="n">DMA</span>
<span class="w">      </span><span class="nl">model_tf_op_layer_stride_1_stride_1</span><span class="p">:</span><span class="n">OpId_24</span><span class="w"> </span><span class="p">(</span><span class="n">cycles</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">10422</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Wait</span><span class="w"> </span><span class="p">(</span><span class="n">Scheduler</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">10075</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">               </span><span class="nl">model_convStart_Conv2D</span><span class="p">:</span><span class="n">OpId_21</span>
<span class="w">               </span><span class="nl">model_tf_op_layer_stride_1_stride_1</span><span class="p">:</span><span class="n">OpId_24</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="p">(</span><span class="n">wait</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="nl">Resources</span><span class="p">:</span><span class="w"> </span><span class="n">HVX</span>
<span class="w">      </span><span class="nl">model_convCombined1_Conv2D</span><span class="p">:</span><span class="n">OpId_34</span><span class="w"> </span><span class="p">(</span><span class="n">cycles</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">337711</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Wait</span><span class="w"> </span><span class="p">(</span><span class="n">Scheduler</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">82</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">307394</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">               </span><span class="n">Output</span><span class="w"> </span><span class="n">OpId_3</span>
<span class="w">               </span><span class="nl">model_tf_op_layer_stride_1_stride_1</span><span class="p">:</span><span class="n">OpId_24</span>
<span class="w">               </span><span class="nl">model_convStart_Conv2D</span><span class="p">:</span><span class="n">OpId_21</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="p">(</span><span class="n">wait</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">50</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">               </span><span class="n">Output</span><span class="w"> </span><span class="n">OpId_3</span>
<span class="w">               </span><span class="nl">model_convStart_Conv2D</span><span class="p">:</span><span class="n">OpId_21</span>
<span class="w">            </span><span class="nl">Resources</span><span class="p">:</span><span class="w"> </span><span class="n">HMX</span><span class="p">,</span><span class="w"> </span><span class="n">DMA</span>
<span class="w">      </span><span class="nl">model_convCombined2_Conv2D</span><span class="p">:</span><span class="n">OpId_41</span><span class="w"> </span><span class="p">(</span><span class="n">cycles</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">295022</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Wait</span><span class="w"> </span><span class="p">(</span><span class="n">Scheduler</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">1184</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">286062</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">               </span><span class="nl">model_add_add</span><span class="p">:</span><span class="n">OpId_50</span>
<span class="w">               </span><span class="n">Output</span><span class="w"> </span><span class="n">OpId_3</span>
<span class="w">               </span><span class="nl">model_convStart_Conv2D</span><span class="p">:</span><span class="n">OpId_21</span>
<span class="w">               </span><span class="nl">model_tf_op_layer_stride_1_stride_1</span><span class="p">:</span><span class="n">OpId_24</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="p">(</span><span class="n">wait</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">1140</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">               </span><span class="nl">model_add_add</span><span class="p">:</span><span class="n">OpId_50</span>
<span class="w">               </span><span class="n">Output</span><span class="w"> </span><span class="n">OpId_3</span>
<span class="w">               </span><span class="nl">model_convStart_Conv2D</span><span class="p">:</span><span class="n">OpId_21</span>
<span class="w">               </span><span class="nl">model_tf_op_layer_stride_1_stride_1</span><span class="p">:</span><span class="n">OpId_24</span>
<span class="w">            </span><span class="nl">Resources</span><span class="p">:</span><span class="w"> </span><span class="n">HMX</span><span class="p">,</span><span class="w"> </span><span class="n">DMA</span>
<span class="w">      </span><span class="nl">model_subConv_Conv2D</span><span class="p">:</span><span class="n">OpId_48</span><span class="w"> </span><span class="p">(</span><span class="n">cycles</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">48720</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Wait</span><span class="w"> </span><span class="p">(</span><span class="n">Scheduler</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">1186</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">46686</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">               </span><span class="nl">model_add_add</span><span class="p">:</span><span class="n">OpId_50</span>
<span class="w">               </span><span class="nl">model_tf_op_layer_stride_1_stride_1</span><span class="p">:</span><span class="n">OpId_24</span>
<span class="w">               </span><span class="n">Output</span><span class="w"> </span><span class="n">OpId_3</span>
<span class="w">               </span><span class="nl">model_convStart_Conv2D</span><span class="p">:</span><span class="n">OpId_21</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="p">(</span><span class="n">wait</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">1142</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">               </span><span class="nl">model_add_add</span><span class="p">:</span><span class="n">OpId_50</span>
<span class="w">               </span><span class="n">Output</span><span class="w"> </span><span class="n">OpId_3</span>
<span class="w">               </span><span class="nl">model_convStart_Conv2D</span><span class="p">:</span><span class="n">OpId_21</span>
<span class="w">            </span><span class="nl">Resources</span><span class="p">:</span><span class="w"> </span><span class="n">HMX</span><span class="p">,</span><span class="w"> </span><span class="n">DMA</span>
<span class="w">      </span><span class="nl">model_add_add</span><span class="p">:</span><span class="n">OpId_50</span><span class="w"> </span><span class="p">(</span><span class="n">cycles</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">110698</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Wait</span><span class="w"> </span><span class="p">(</span><span class="n">Scheduler</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">108524</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">               </span><span class="nl">model_add_add</span><span class="p">:</span><span class="n">OpId_50</span>
<span class="w">               </span><span class="n">Output</span><span class="w"> </span><span class="n">OpId_3</span>
<span class="w">               </span><span class="nl">model_convStart_Conv2D</span><span class="p">:</span><span class="n">OpId_21</span>
<span class="w">               </span><span class="nl">model_tf_op_layer_stride_1_stride_1</span><span class="p">:</span><span class="n">OpId_24</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="p">(</span><span class="n">wait</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="nl">Resources</span><span class="p">:</span><span class="w"> </span><span class="n">HVX</span>
<span class="w">      </span><span class="n">Output</span><span class="w"> </span><span class="n">OpId_3</span><span class="w"> </span><span class="p">(</span><span class="n">cycles</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">77054</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Wait</span><span class="w"> </span><span class="p">(</span><span class="n">Scheduler</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">75438</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="p">(</span><span class="n">wait</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="nl">Resources</span><span class="p">:</span><span class="w"> </span><span class="n">HVX</span>
</pre></div>
</div>
<p>The total execution time has decreased significantly as a result of removing the sub op. All the ops
also have significant amount of parallel op execution - as evidenced by their respective Overlap time
numbers - indicating good optimization.
<a class="reference internal" href="#qnn-htp-profiling-showcase-model-original2-figure"><span class="std std-ref">Showcase Model 2</span></a> diagram illustrates a model
that is similar to the one in the <a class="reference internal" href="#qnn-htp-profiling-showcase-model-original1-figure"><span class="std std-ref">Showcase Model 1</span></a>
diagram. The difference is that there is a div op in place of the problematic sub op.</p>
<p class="centered" id="qnn-htp-profiling-showcase-model-original2-figure">
<strong><strong>Showcase Model 2</strong></strong></p><div class="figure align-center">
<img alt="QNN HTP Profiling Showcase Model 2" src="../../_static/resources/qnn_htp_profiling_showcase_model_original_2.png" />
</div>
<p>The linting profiling output for this model is given below:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">Execute</span><span class="w"> </span><span class="n">Stats</span><span class="w"> </span><span class="p">(</span><span class="n">Average</span><span class="p">)</span><span class="o">:</span>
<span class="o">------------------------</span>
<span class="n">Total</span><span class="w"> </span><span class="n">Inference</span><span class="w"> </span><span class="n">Time</span><span class="o">:</span>
<span class="o">---------------------</span>
<span class="w">   </span><span class="nl">NetRun</span><span class="p">:</span><span class="w">  </span><span class="mi">19353</span><span class="w"> </span><span class="n">us</span>
<span class="w">   </span><span class="n">Backend</span><span class="w"> </span><span class="p">(</span><span class="n">RPC</span><span class="w"> </span><span class="p">(</span><span class="n">execute</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">18679</span><span class="w">  </span><span class="n">us</span>
<span class="w">   </span><span class="n">Backend</span><span class="w"> </span><span class="p">(</span><span class="n">QNN</span><span class="w"> </span><span class="n">accelerator</span><span class="w"> </span><span class="p">(</span><span class="n">execute</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">17700</span><span class="w">  </span><span class="n">us</span>
<span class="w">   </span><span class="n">Backend</span><span class="w"> </span><span class="p">(</span><span class="n">Num</span><span class="w"> </span><span class="n">times</span><span class="w"> </span><span class="n">yield</span><span class="w"> </span><span class="n">occured</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">count</span>
<span class="w">   </span><span class="n">Backend</span><span class="w"> </span><span class="p">(</span><span class="n">Time</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">initial</span><span class="w"> </span><span class="n">VTCM</span><span class="w"> </span><span class="n">acquire</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">us</span>
<span class="w">   </span><span class="n">Backend</span><span class="w"> </span><span class="p">(</span><span class="n">Time</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">HVX</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">HMX</span><span class="w"> </span><span class="n">power</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">acquire</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">us</span>
<span class="w">   </span><span class="n">Backend</span><span class="w"> </span><span class="p">(</span><span class="n">Accelerator</span><span class="w"> </span><span class="p">(</span><span class="n">critical</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="n">execute</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="p">(</span><span class="n">cycles</span><span class="p">))</span><span class="o">:</span><span class="w"> </span><span class="mi">7866535</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">      </span><span class="n">Input</span><span class="w"> </span><span class="n">OpId_2</span><span class="w"> </span><span class="p">(</span><span class="n">cycles</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Wait</span><span class="w"> </span><span class="p">(</span><span class="n">Scheduler</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="p">(</span><span class="n">wait</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="nl">Resources</span><span class="p">:</span>
<span class="w">      </span><span class="n">OpId_0</span><span class="w"> </span><span class="p">(</span><span class="n">cycles</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">8657</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Wait</span><span class="w"> </span><span class="p">(</span><span class="n">Scheduler</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">782</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">5155</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="p">(</span><span class="n">wait</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">717</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="nl">Resources</span><span class="p">:</span>
<span class="w">      </span><span class="nl">model_convStart_Conv2D</span><span class="p">:</span><span class="n">OpId_21</span><span class="w"> </span><span class="p">(</span><span class="n">cycles</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">148293</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Wait</span><span class="w"> </span><span class="p">(</span><span class="n">Scheduler</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">34</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">86500</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">               </span><span class="nl">model_tf_op_layer_RealDiv_RealDiv</span><span class="p">:</span><span class="n">OpId_57</span>
<span class="w">               </span><span class="n">Output</span><span class="w"> </span><span class="n">OpId_3</span>
<span class="w">               </span><span class="nl">model_add_add</span><span class="p">:</span><span class="n">OpId_58</span>
<span class="w">               </span><span class="nl">model_tf_op_layer_stride_stride</span><span class="p">:</span><span class="n">OpId_24</span>
<span class="w">               </span><span class="nl">model_convStart_Conv2D</span><span class="p">:</span><span class="n">OpId_21</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="p">(</span><span class="n">wait</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">34</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">               </span><span class="nl">model_convStart_Conv2D</span><span class="p">:</span><span class="n">OpId_21</span>
<span class="w">            </span><span class="nl">Resources</span><span class="p">:</span><span class="w"> </span><span class="n">HVX</span><span class="p">,</span><span class="w"> </span><span class="n">HMX</span><span class="p">,</span><span class="w"> </span><span class="n">DMA</span>
<span class="w">      </span><span class="nl">model_tf_op_layer_stride_stride</span><span class="p">:</span><span class="n">OpId_24</span><span class="w"> </span><span class="p">(</span><span class="n">cycles</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">145084</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Wait</span><span class="w"> </span><span class="p">(</span><span class="n">Scheduler</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">70877</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">               </span><span class="nl">model_convStart_Conv2D</span><span class="p">:</span><span class="n">OpId_21</span>
<span class="w">               </span><span class="nl">model_add_add</span><span class="p">:</span><span class="n">OpId_58</span>
<span class="w">               </span><span class="n">Output</span><span class="w"> </span><span class="n">OpId_3</span>
<span class="w">               </span><span class="nl">model_tf_op_layer_stride_stride</span><span class="p">:</span><span class="n">OpId_24</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="p">(</span><span class="n">wait</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="nl">Resources</span><span class="p">:</span><span class="w"> </span><span class="n">HVX</span>
<span class="w">      </span><span class="nl">model_convLeft1_Conv2D</span><span class="p">:</span><span class="n">OpId_34</span><span class="w"> </span><span class="p">(</span><span class="n">cycles</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">285476</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Wait</span><span class="w"> </span><span class="p">(</span><span class="n">Scheduler</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">431</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">196212</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">               </span><span class="n">Output</span><span class="w"> </span><span class="n">OpId_3</span>
<span class="w">               </span><span class="nl">model_tf_op_layer_stride_stride</span><span class="p">:</span><span class="n">OpId_24</span>
<span class="w">               </span><span class="nl">model_convStart_Conv2D</span><span class="p">:</span><span class="n">OpId_21</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="p">(</span><span class="n">wait</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">318</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">               </span><span class="n">Output</span><span class="w"> </span><span class="n">OpId_3</span>
<span class="w">               </span><span class="nl">model_tf_op_layer_stride_stride</span><span class="p">:</span><span class="n">OpId_24</span>
<span class="w">               </span><span class="nl">model_convStart_Conv2D</span><span class="p">:</span><span class="n">OpId_21</span>
<span class="w">            </span><span class="nl">Resources</span><span class="p">:</span><span class="w"> </span><span class="n">HMX</span><span class="p">,</span><span class="w"> </span><span class="n">DMA</span>
<span class="w">      </span><span class="nl">model_convRight1_Conv2D</span><span class="p">:</span><span class="n">OpId_41</span><span class="w"> </span><span class="p">(</span><span class="n">cycles</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">219298</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Wait</span><span class="w"> </span><span class="p">(</span><span class="n">Scheduler</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">804</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">134711</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">               </span><span class="n">Output</span><span class="w"> </span><span class="n">OpId_3</span>
<span class="w">               </span><span class="nl">model_tf_op_layer_stride_stride</span><span class="p">:</span><span class="n">OpId_24</span>
<span class="w">               </span><span class="nl">model_convStart_Conv2D</span><span class="p">:</span><span class="n">OpId_21</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="p">(</span><span class="n">wait</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">558</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">               </span><span class="n">Output</span><span class="w"> </span><span class="n">OpId_3</span>
<span class="w">               </span><span class="nl">model_tf_op_layer_stride_stride</span><span class="p">:</span><span class="n">OpId_24</span>
<span class="w">               </span><span class="nl">model_convStart_Conv2D</span><span class="p">:</span><span class="n">OpId_21</span>
<span class="w">            </span><span class="nl">Resources</span><span class="p">:</span><span class="w"> </span><span class="n">HMX</span><span class="p">,</span><span class="w"> </span><span class="n">DMA</span>
<span class="w">      </span><span class="nl">model_convRight2_Conv2D</span><span class="p">:</span><span class="n">OpId_48</span><span class="w"> </span><span class="p">(</span><span class="n">cycles</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">181198</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Wait</span><span class="w"> </span><span class="p">(</span><span class="n">Scheduler</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">1083</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">68306</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">               </span><span class="nl">model_tf_op_layer_RealDiv_RealDiv</span><span class="p">:</span><span class="n">OpId_57</span>
<span class="w">               </span><span class="n">Output</span><span class="w"> </span><span class="n">OpId_3</span>
<span class="w">               </span><span class="nl">model_tf_op_layer_stride_stride</span><span class="p">:</span><span class="n">OpId_24</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="p">(</span><span class="n">wait</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">476</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">               </span><span class="nl">model_tf_op_layer_RealDiv_RealDiv</span><span class="p">:</span><span class="n">OpId_57</span>
<span class="w">               </span><span class="n">Output</span><span class="w"> </span><span class="n">OpId_3</span>
<span class="w">            </span><span class="nl">Resources</span><span class="p">:</span><span class="w"> </span><span class="n">HMX</span><span class="p">,</span><span class="w"> </span><span class="n">DMA</span>
<span class="w">      </span><span class="nl">model_convLeft2_Conv2D</span><span class="p">:</span><span class="n">OpId_55</span><span class="w"> </span><span class="p">(</span><span class="n">cycles</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">233731</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Wait</span><span class="w"> </span><span class="p">(</span><span class="n">Scheduler</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">1055</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">91960</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">               </span><span class="nl">model_tf_op_layer_RealDiv_RealDiv</span><span class="p">:</span><span class="n">OpId_57</span>
<span class="w">               </span><span class="n">Output</span><span class="w"> </span><span class="n">OpId_3</span>
<span class="w">               </span><span class="nl">model_add_add</span><span class="p">:</span><span class="n">OpId_58</span>
<span class="w">               </span><span class="nl">model_tf_op_layer_stride_stride</span><span class="p">:</span><span class="n">OpId_24</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="p">(</span><span class="n">wait</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">447</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">               </span><span class="nl">model_tf_op_layer_RealDiv_RealDiv</span><span class="p">:</span><span class="n">OpId_57</span>
<span class="w">               </span><span class="n">Output</span><span class="w"> </span><span class="n">OpId_3</span>
<span class="w">            </span><span class="nl">Resources</span><span class="p">:</span><span class="w"> </span><span class="n">HMX</span><span class="p">,</span><span class="w"> </span><span class="n">DMA</span>
<span class="w">      </span><span class="nl">model_tf_op_layer_RealDiv_RealDiv</span><span class="p">:</span><span class="n">OpId_57</span><span class="w"> </span><span class="p">(</span><span class="n">cycles</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">5344081</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Wait</span><span class="w"> </span><span class="p">(</span><span class="n">Scheduler</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">528123</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">               </span><span class="nl">model_tf_op_layer_RealDiv_RealDiv</span><span class="p">:</span><span class="n">OpId_57</span>
<span class="w">               </span><span class="n">Output</span><span class="w"> </span><span class="n">OpId_3</span>
<span class="w">               </span><span class="nl">model_add_add</span><span class="p">:</span><span class="n">OpId_58</span>
<span class="w">               </span><span class="nl">model_convStart_Conv2D</span><span class="p">:</span><span class="n">OpId_21</span>
<span class="w">               </span><span class="nl">model_tf_op_layer_stride_stride</span><span class="p">:</span><span class="n">OpId_24</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="p">(</span><span class="n">wait</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="nl">Resources</span><span class="p">:</span><span class="w"> </span><span class="n">HVX</span>
<span class="w">      </span><span class="nl">model_add_add</span><span class="p">:</span><span class="n">OpId_58</span><span class="w"> </span><span class="p">(</span><span class="n">cycles</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">525199</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Wait</span><span class="w"> </span><span class="p">(</span><span class="n">Scheduler</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">481084</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">               </span><span class="nl">model_convStart_Conv2D</span><span class="p">:</span><span class="n">OpId_21</span>
<span class="w">               </span><span class="nl">model_tf_op_layer_stride_stride</span><span class="p">:</span><span class="n">OpId_24</span>
<span class="w">               </span><span class="n">Output</span><span class="w"> </span><span class="n">OpId_3</span>
<span class="w">               </span><span class="nl">model_add_add</span><span class="p">:</span><span class="n">OpId_58</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="p">(</span><span class="n">wait</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="nl">Resources</span><span class="p">:</span><span class="w"> </span><span class="n">HVX</span>
<span class="w">      </span><span class="n">Output</span><span class="w"> </span><span class="n">OpId_3</span><span class="w"> </span><span class="p">(</span><span class="n">cycles</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">771320</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Wait</span><span class="w"> </span><span class="p">(</span><span class="n">Scheduler</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">115729</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="p">(</span><span class="n">wait</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="nl">Resources</span><span class="p">:</span><span class="w"> </span><span class="n">HVX</span>
</pre></div>
</div>
<p>Again, the bottleneck for this graph can be identified by examining the main and background utilization
of each op. In this case, the div op is the major contributor to the overall graph execution time with it
taking up 5344081 cycles - about 68% of the total execution time. Only about 10% of this op’s execution
has some parallel background activity which again indicates a good potential for performance gain through
optimization. Replacing the div op with a mul op is a suggested optimization strategy found in the best
practices guidelines. The linting profiler output for the graph optimized with a mult op instead of a div
op is given below:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">Execute</span><span class="w"> </span><span class="n">Stats</span><span class="w"> </span><span class="p">(</span><span class="n">Average</span><span class="p">)</span><span class="o">:</span>
<span class="o">------------------------</span>
<span class="n">Total</span><span class="w"> </span><span class="n">Inference</span><span class="w"> </span><span class="n">Time</span><span class="o">:</span>
<span class="o">---------------------</span>
<span class="w">   </span><span class="nl">NetRun</span><span class="p">:</span><span class="w">  </span><span class="mi">15755</span><span class="w"> </span><span class="n">us</span>
<span class="w">   </span><span class="n">Backend</span><span class="w"> </span><span class="p">(</span><span class="n">RPC</span><span class="w"> </span><span class="p">(</span><span class="n">execute</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">15274</span><span class="w">  </span><span class="n">us</span>
<span class="w">   </span><span class="n">Backend</span><span class="w"> </span><span class="p">(</span><span class="n">QNN</span><span class="w"> </span><span class="n">accelerator</span><span class="w"> </span><span class="p">(</span><span class="n">execute</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">14108</span><span class="w">  </span><span class="n">us</span>
<span class="w">   </span><span class="n">Backend</span><span class="w"> </span><span class="p">(</span><span class="n">Num</span><span class="w"> </span><span class="n">times</span><span class="w"> </span><span class="n">yield</span><span class="w"> </span><span class="n">occured</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">count</span>
<span class="w">   </span><span class="n">Backend</span><span class="w"> </span><span class="p">(</span><span class="n">Time</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">initial</span><span class="w"> </span><span class="n">VTCM</span><span class="w"> </span><span class="n">acquire</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">us</span>
<span class="w">   </span><span class="n">Backend</span><span class="w"> </span><span class="p">(</span><span class="n">Time</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">HVX</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">HMX</span><span class="w"> </span><span class="n">power</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">acquire</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">us</span>
<span class="w">   </span><span class="n">Backend</span><span class="w"> </span><span class="p">(</span><span class="n">Accelerator</span><span class="w"> </span><span class="p">(</span><span class="n">critical</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="n">execute</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="p">(</span><span class="n">cycles</span><span class="p">))</span><span class="o">:</span><span class="w"> </span><span class="mi">2741387</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">      </span><span class="n">Input</span><span class="w"> </span><span class="n">OpId_2</span><span class="w"> </span><span class="p">(</span><span class="n">cycles</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Wait</span><span class="w"> </span><span class="p">(</span><span class="n">Scheduler</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="p">(</span><span class="n">wait</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="nl">Resources</span><span class="p">:</span>
<span class="w">      </span><span class="n">OpId_0</span><span class="w"> </span><span class="p">(</span><span class="n">cycles</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">8067</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Wait</span><span class="w"> </span><span class="p">(</span><span class="n">Scheduler</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">735</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">4781</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="p">(</span><span class="n">wait</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">669</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="nl">Resources</span><span class="p">:</span>
<span class="w">      </span><span class="nl">model_convStart_Conv2D</span><span class="p">:</span><span class="n">OpId_21</span><span class="w"> </span><span class="p">(</span><span class="n">cycles</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">147478</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Wait</span><span class="w"> </span><span class="p">(</span><span class="n">Scheduler</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">32</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">86319</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">               </span><span class="nl">model_multiply_mul</span><span class="p">:</span><span class="n">OpId_57</span>
<span class="w">               </span><span class="n">Output</span><span class="w"> </span><span class="n">OpId_3</span>
<span class="w">               </span><span class="nl">model_add_add</span><span class="p">:</span><span class="n">OpId_58</span>
<span class="w">               </span><span class="nl">model_tf_op_layer_stride_stride</span><span class="p">:</span><span class="n">OpId_24</span>
<span class="w">               </span><span class="nl">model_convStart_Conv2D</span><span class="p">:</span><span class="n">OpId_21</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="p">(</span><span class="n">wait</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">32</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">               </span><span class="nl">model_convStart_Conv2D</span><span class="p">:</span><span class="n">OpId_21</span>
<span class="w">            </span><span class="nl">Resources</span><span class="p">:</span><span class="w"> </span><span class="n">HVX</span><span class="p">,</span><span class="w"> </span><span class="n">HMX</span><span class="p">,</span><span class="w"> </span><span class="n">DMA</span>
<span class="w">      </span><span class="nl">model_tf_op_layer_stride_stride</span><span class="p">:</span><span class="n">OpId_24</span><span class="w"> </span><span class="p">(</span><span class="n">cycles</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">145396</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Wait</span><span class="w"> </span><span class="p">(</span><span class="n">Scheduler</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">70208</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">               </span><span class="nl">model_convStart_Conv2D</span><span class="p">:</span><span class="n">OpId_21</span>
<span class="w">               </span><span class="nl">model_add_add</span><span class="p">:</span><span class="n">OpId_58</span>
<span class="w">               </span><span class="n">Output</span><span class="w"> </span><span class="n">OpId_3</span>
<span class="w">               </span><span class="nl">model_tf_op_layer_stride_stride</span><span class="p">:</span><span class="n">OpId_24</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="p">(</span><span class="n">wait</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="nl">Resources</span><span class="p">:</span><span class="w"> </span><span class="n">HVX</span>
<span class="w">      </span><span class="nl">model_convLeft1_Conv2D</span><span class="p">:</span><span class="n">OpId_34</span><span class="w"> </span><span class="p">(</span><span class="n">cycles</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">287130</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Wait</span><span class="w"> </span><span class="p">(</span><span class="n">Scheduler</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">430</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">198222</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">               </span><span class="n">Output</span><span class="w"> </span><span class="n">OpId_3</span>
<span class="w">               </span><span class="nl">model_add_add</span><span class="p">:</span><span class="n">OpId_58</span>
<span class="w">               </span><span class="nl">model_tf_op_layer_stride_stride</span><span class="p">:</span><span class="n">OpId_24</span>
<span class="w">               </span><span class="nl">model_convStart_Conv2D</span><span class="p">:</span><span class="n">OpId_21</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="p">(</span><span class="n">wait</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">308</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">               </span><span class="n">Output</span><span class="w"> </span><span class="n">OpId_3</span>
<span class="w">               </span><span class="nl">model_add_add</span><span class="p">:</span><span class="n">OpId_58</span>
<span class="w">               </span><span class="nl">model_tf_op_layer_stride_stride</span><span class="p">:</span><span class="n">OpId_24</span>
<span class="w">               </span><span class="nl">model_convStart_Conv2D</span><span class="p">:</span><span class="n">OpId_21</span>
<span class="w">            </span><span class="nl">Resources</span><span class="p">:</span><span class="w"> </span><span class="n">HMX</span><span class="p">,</span><span class="w"> </span><span class="n">DMA</span>
<span class="w">      </span><span class="nl">model_convRight1_Conv2D</span><span class="p">:</span><span class="n">OpId_41</span><span class="w"> </span><span class="p">(</span><span class="n">cycles</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">219409</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Wait</span><span class="w"> </span><span class="p">(</span><span class="n">Scheduler</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">806</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">135286</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">               </span><span class="n">Output</span><span class="w"> </span><span class="n">OpId_3</span>
<span class="w">               </span><span class="nl">model_add_add</span><span class="p">:</span><span class="n">OpId_58</span>
<span class="w">               </span><span class="nl">model_tf_op_layer_stride_stride</span><span class="p">:</span><span class="n">OpId_24</span>
<span class="w">               </span><span class="nl">model_convStart_Conv2D</span><span class="p">:</span><span class="n">OpId_21</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="p">(</span><span class="n">wait</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">558</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">               </span><span class="n">Output</span><span class="w"> </span><span class="n">OpId_3</span>
<span class="w">               </span><span class="nl">model_tf_op_layer_stride_stride</span><span class="p">:</span><span class="n">OpId_24</span>
<span class="w">               </span><span class="nl">model_convStart_Conv2D</span><span class="p">:</span><span class="n">OpId_21</span>
<span class="w">            </span><span class="nl">Resources</span><span class="p">:</span><span class="w"> </span><span class="n">HMX</span><span class="p">,</span><span class="w"> </span><span class="n">DMA</span>
<span class="w">      </span><span class="nl">model_convRight2_Conv2D</span><span class="p">:</span><span class="n">OpId_48</span><span class="w"> </span><span class="p">(</span><span class="n">cycles</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">181465</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Wait</span><span class="w"> </span><span class="p">(</span><span class="n">Scheduler</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">1068</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">69160</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">               </span><span class="nl">model_multiply_mul</span><span class="p">:</span><span class="n">OpId_57</span>
<span class="w">               </span><span class="nl">model_convStart_Conv2D</span><span class="p">:</span><span class="n">OpId_21</span>
<span class="w">               </span><span class="n">Output</span><span class="w"> </span><span class="n">OpId_3</span>
<span class="w">               </span><span class="nl">model_add_add</span><span class="p">:</span><span class="n">OpId_58</span>
<span class="w">               </span><span class="nl">model_tf_op_layer_stride_stride</span><span class="p">:</span><span class="n">OpId_24</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="p">(</span><span class="n">wait</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">467</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">               </span><span class="nl">model_multiply_mul</span><span class="p">:</span><span class="n">OpId_57</span>
<span class="w">               </span><span class="nl">model_convStart_Conv2D</span><span class="p">:</span><span class="n">OpId_21</span>
<span class="w">               </span><span class="n">Output</span><span class="w"> </span><span class="n">OpId_3</span>
<span class="w">               </span><span class="nl">model_add_add</span><span class="p">:</span><span class="n">OpId_58</span>
<span class="w">            </span><span class="nl">Resources</span><span class="p">:</span><span class="w"> </span><span class="n">HMX</span><span class="p">,</span><span class="w"> </span><span class="n">DMA</span>
<span class="w">      </span><span class="nl">model_convLeft2_Conv2D</span><span class="p">:</span><span class="n">OpId_55</span><span class="w"> </span><span class="p">(</span><span class="n">cycles</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">233619</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Wait</span><span class="w"> </span><span class="p">(</span><span class="n">Scheduler</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">1055</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">92740</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">               </span><span class="nl">model_multiply_mul</span><span class="p">:</span><span class="n">OpId_57</span>
<span class="w">               </span><span class="nl">model_convStart_Conv2D</span><span class="p">:</span><span class="n">OpId_21</span>
<span class="w">               </span><span class="n">Output</span><span class="w"> </span><span class="n">OpId_3</span>
<span class="w">               </span><span class="nl">model_add_add</span><span class="p">:</span><span class="n">OpId_58</span>
<span class="w">               </span><span class="nl">model_tf_op_layer_stride_stride</span><span class="p">:</span><span class="n">OpId_24</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="p">(</span><span class="n">wait</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">445</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">               </span><span class="nl">model_multiply_mul</span><span class="p">:</span><span class="n">OpId_57</span>
<span class="w">               </span><span class="nl">model_convStart_Conv2D</span><span class="p">:</span><span class="n">OpId_21</span>
<span class="w">               </span><span class="n">Output</span><span class="w"> </span><span class="n">OpId_3</span>
<span class="w">               </span><span class="nl">model_add_add</span><span class="p">:</span><span class="n">OpId_58</span>
<span class="w">            </span><span class="nl">Resources</span><span class="p">:</span><span class="w"> </span><span class="n">HMX</span><span class="p">,</span><span class="w"> </span><span class="n">DMA</span>
<span class="w">      </span><span class="nl">model_multiply_mul</span><span class="p">:</span><span class="n">OpId_57</span><span class="w"> </span><span class="p">(</span><span class="n">cycles</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">737978</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Wait</span><span class="w"> </span><span class="p">(</span><span class="n">Scheduler</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">437784</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">               </span><span class="nl">model_multiply_mul</span><span class="p">:</span><span class="n">OpId_57</span>
<span class="w">               </span><span class="n">Output</span><span class="w"> </span><span class="n">OpId_3</span>
<span class="w">               </span><span class="nl">model_add_add</span><span class="p">:</span><span class="n">OpId_58</span>
<span class="w">               </span><span class="nl">model_convStart_Conv2D</span><span class="p">:</span><span class="n">OpId_21</span>
<span class="w">               </span><span class="nl">model_tf_op_layer_stride_stride</span><span class="p">:</span><span class="n">OpId_24</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="p">(</span><span class="n">wait</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="nl">Resources</span><span class="p">:</span><span class="w"> </span><span class="n">HVX</span>
<span class="w">      </span><span class="nl">model_add_add</span><span class="p">:</span><span class="n">OpId_58</span><span class="w"> </span><span class="p">(</span><span class="n">cycles</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">527450</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Wait</span><span class="w"> </span><span class="p">(</span><span class="n">Scheduler</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">481714</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">               </span><span class="nl">model_convStart_Conv2D</span><span class="p">:</span><span class="n">OpId_21</span>
<span class="w">               </span><span class="nl">model_tf_op_layer_stride_stride</span><span class="p">:</span><span class="n">OpId_24</span>
<span class="w">               </span><span class="n">Output</span><span class="w"> </span><span class="n">OpId_3</span>
<span class="w">               </span><span class="nl">model_add_add</span><span class="p">:</span><span class="n">OpId_58</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="p">(</span><span class="n">wait</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="nl">Resources</span><span class="p">:</span><span class="w"> </span><span class="n">HVX</span>
<span class="w">      </span><span class="n">Output</span><span class="w"> </span><span class="n">OpId_3</span><span class="w"> </span><span class="p">(</span><span class="n">cycles</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">249264</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Wait</span><span class="w"> </span><span class="p">(</span><span class="n">Scheduler</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">117890</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="p">(</span><span class="n">wait</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="nl">Resources</span><span class="p">:</span><span class="w"> </span><span class="n">HVX</span>
</pre></div>
</div>
<p>There is a noticeable reduction in the total graph execute time and the ops also have better background
utilization indicating better optimization than before.
Next, <a class="reference internal" href="#qnn-htp-profiling-showcase-model-original3-figure"><span class="std std-ref">Showcase Model 3</span></a> diagram illustrates a model that is
similar to the one in <a class="reference internal" href="#qnn-htp-profiling-showcase-model-optimized1-figure"><span class="std std-ref">Showcase Model 1 Optimized</span></a>
diagram. The difference is that the ReLU ops have been replaced with PReLU ops.</p>
<p class="centered" id="qnn-htp-profiling-showcase-model-original3-figure">
<strong><strong>Showcase Model 3</strong></strong></p><div class="figure align-center">
<img alt="QNN HTP Profiling Showcase Model 3" src="../../_static/resources/qnn_htp_profiling_showcase_model_original_3.png" />
</div>
<p>The linting profiler output for this model is given below:</p>
<div class="highlight-c notranslate"><div class="highlight"><pre><span></span><span class="n">Execute</span><span class="w"> </span><span class="n">Stats</span><span class="w"> </span><span class="p">(</span><span class="n">Average</span><span class="p">)</span><span class="o">:</span>
<span class="o">------------------------</span>
<span class="n">Total</span><span class="w"> </span><span class="n">Inference</span><span class="w"> </span><span class="n">Time</span><span class="o">:</span>
<span class="o">---------------------</span>
<span class="w">   </span><span class="nl">NetRun</span><span class="p">:</span><span class="w">  </span><span class="mi">15368</span><span class="w"> </span><span class="n">us</span>
<span class="w">   </span><span class="n">Backend</span><span class="w"> </span><span class="p">(</span><span class="n">RPC</span><span class="w"> </span><span class="p">(</span><span class="n">execute</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">15033</span><span class="w">  </span><span class="n">us</span>
<span class="w">   </span><span class="n">Backend</span><span class="w"> </span><span class="p">(</span><span class="n">QNN</span><span class="w"> </span><span class="n">accelerator</span><span class="w"> </span><span class="p">(</span><span class="n">execute</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">13863</span><span class="w">  </span><span class="n">us</span>
<span class="w">   </span><span class="n">Backend</span><span class="w"> </span><span class="p">(</span><span class="n">Num</span><span class="w"> </span><span class="n">times</span><span class="w"> </span><span class="n">yield</span><span class="w"> </span><span class="n">occured</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">count</span>
<span class="w">   </span><span class="n">Backend</span><span class="w"> </span><span class="p">(</span><span class="n">Time</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">initial</span><span class="w"> </span><span class="n">VTCM</span><span class="w"> </span><span class="n">acquire</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">us</span>
<span class="w">   </span><span class="n">Backend</span><span class="w"> </span><span class="p">(</span><span class="n">Time</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">HVX</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">HMX</span><span class="w"> </span><span class="n">power</span><span class="w"> </span><span class="n">on</span><span class="w"> </span><span class="n">and</span><span class="w"> </span><span class="n">acquire</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">us</span>
<span class="w">   </span><span class="n">Backend</span><span class="w"> </span><span class="p">(</span><span class="n">Accelerator</span><span class="w"> </span><span class="p">(</span><span class="n">critical</span><span class="w"> </span><span class="n">path</span><span class="w"> </span><span class="n">execute</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="p">(</span><span class="n">cycles</span><span class="p">))</span><span class="o">:</span><span class="w"> </span><span class="mi">2789467</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">      </span><span class="n">Input</span><span class="w"> </span><span class="n">OpId_2</span><span class="w"> </span><span class="p">(</span><span class="n">cycles</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Wait</span><span class="w"> </span><span class="p">(</span><span class="n">Scheduler</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="p">(</span><span class="n">wait</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="nl">Resources</span><span class="p">:</span>
<span class="w">      </span><span class="n">OpId_0</span><span class="w"> </span><span class="p">(</span><span class="n">cycles</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">3411</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Wait</span><span class="w"> </span><span class="p">(</span><span class="n">Scheduler</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">1226</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">3173</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="p">(</span><span class="n">wait</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">1194</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="nl">Resources</span><span class="p">:</span>
<span class="w">      </span><span class="nl">model_convStart_Conv2D</span><span class="p">:</span><span class="n">OpId_21</span><span class="w"> </span><span class="p">(</span><span class="n">cycles</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">589431</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Wait</span><span class="w"> </span><span class="p">(</span><span class="n">Scheduler</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">957</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">41199</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">               </span><span class="n">Output</span><span class="w"> </span><span class="n">OpId_3</span>
<span class="w">               </span><span class="nl">model_add_add</span><span class="p">:</span><span class="n">OpId_54</span>
<span class="w">               </span><span class="nl">model_preluCombined1_add</span><span class="p">:</span><span class="n">OpId_37</span>
<span class="w">               </span><span class="nl">model_convStart_Conv2D</span><span class="p">:</span><span class="n">OpId_21</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="p">(</span><span class="n">wait</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">72</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">               </span><span class="n">Output</span><span class="w"> </span><span class="n">OpId_3</span>
<span class="w">               </span><span class="nl">model_convStart_Conv2D</span><span class="p">:</span><span class="n">OpId_21</span>
<span class="w">            </span><span class="nl">Resources</span><span class="p">:</span><span class="w"> </span><span class="n">HVX</span><span class="p">,</span><span class="w"> </span><span class="n">HMX</span><span class="p">,</span><span class="w"> </span><span class="n">DMA</span>
<span class="w">      </span><span class="nl">model_tf_op_layer_stride_1_stride_1</span><span class="p">:</span><span class="n">OpId_24</span><span class="w"> </span><span class="p">(</span><span class="n">cycles</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Wait</span><span class="w"> </span><span class="p">(</span><span class="n">Scheduler</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="p">(</span><span class="n">wait</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="nl">Resources</span><span class="p">:</span>
<span class="w">      </span><span class="nl">model_convCombined1_Conv2D</span><span class="p">:</span><span class="n">OpId_34</span><span class="w"> </span><span class="p">(</span><span class="n">cycles</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">165119</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Wait</span><span class="w"> </span><span class="p">(</span><span class="n">Scheduler</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">1089</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">155164</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">               </span><span class="nl">model_preluCombined1_add</span><span class="p">:</span><span class="n">OpId_37</span>
<span class="w">               </span><span class="n">Output</span><span class="w"> </span><span class="n">OpId_3</span>
<span class="w">               </span><span class="nl">model_add_add</span><span class="p">:</span><span class="n">OpId_54</span>
<span class="w">               </span><span class="nl">model_convStart_Conv2D</span><span class="p">:</span><span class="n">OpId_21</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="p">(</span><span class="n">wait</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">977</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">               </span><span class="nl">model_preluCombined1_add</span><span class="p">:</span><span class="n">OpId_37</span>
<span class="w">               </span><span class="n">Output</span><span class="w"> </span><span class="n">OpId_3</span>
<span class="w">               </span><span class="nl">model_add_add</span><span class="p">:</span><span class="n">OpId_54</span>
<span class="w">               </span><span class="nl">model_convStart_Conv2D</span><span class="p">:</span><span class="n">OpId_21</span>
<span class="w">            </span><span class="nl">Resources</span><span class="p">:</span><span class="w"> </span><span class="n">HMX</span><span class="p">,</span><span class="w"> </span><span class="n">DMA</span>
<span class="w">      </span><span class="nl">model_preluCombined1_add</span><span class="p">:</span><span class="n">OpId_37</span><span class="w"> </span><span class="p">(</span><span class="n">cycles</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">27315</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Wait</span><span class="w"> </span><span class="p">(</span><span class="n">Scheduler</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">9431</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">               </span><span class="nl">model_convStart_Conv2D</span><span class="p">:</span><span class="n">OpId_21</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="p">(</span><span class="n">wait</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="nl">Resources</span><span class="p">:</span><span class="w"> </span><span class="n">HVX</span>
<span class="w">      </span><span class="nl">model_convCombined2_Conv2D</span><span class="p">:</span><span class="n">OpId_43</span><span class="w"> </span><span class="p">(</span><span class="n">cycles</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">805490</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Wait</span><span class="w"> </span><span class="p">(</span><span class="n">Scheduler</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">81</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">251743</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">               </span><span class="nl">model_add_add</span><span class="p">:</span><span class="n">OpId_54</span>
<span class="w">               </span><span class="n">Output</span><span class="w"> </span><span class="n">OpId_3</span>
<span class="w">               </span><span class="nl">model_preluCombined1_add</span><span class="p">:</span><span class="n">OpId_37</span>
<span class="w">               </span><span class="nl">model_preluCombined2_add</span><span class="p">:</span><span class="n">OpId_46</span>
<span class="w">               </span><span class="nl">model_convStart_Conv2D</span><span class="p">:</span><span class="n">OpId_21</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="p">(</span><span class="n">wait</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">62</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">               </span><span class="n">Output</span><span class="w"> </span><span class="n">OpId_3</span>
<span class="w">               </span><span class="nl">model_convStart_Conv2D</span><span class="p">:</span><span class="n">OpId_21</span>
<span class="w">            </span><span class="nl">Resources</span><span class="p">:</span><span class="w"> </span><span class="n">HMX</span><span class="p">,</span><span class="w"> </span><span class="n">DMA</span>
<span class="w">      </span><span class="nl">model_preluCombined2_add</span><span class="p">:</span><span class="n">OpId_46</span><span class="w"> </span><span class="p">(</span><span class="n">cycles</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Wait</span><span class="w"> </span><span class="p">(</span><span class="n">Scheduler</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="p">(</span><span class="n">wait</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="nl">Resources</span><span class="p">:</span><span class="w"> </span><span class="n">HVX</span>
<span class="w">      </span><span class="nl">model_subConv_Conv2D</span><span class="p">:</span><span class="n">OpId_52</span><span class="w"> </span><span class="p">(</span><span class="n">cycles</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">666721</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Wait</span><span class="w"> </span><span class="p">(</span><span class="n">Scheduler</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">34</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">180805</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">               </span><span class="nl">model_add_add</span><span class="p">:</span><span class="n">OpId_54</span>
<span class="w">               </span><span class="n">Output</span><span class="w"> </span><span class="n">OpId_3</span>
<span class="w">               </span><span class="nl">model_convStart_Conv2D</span><span class="p">:</span><span class="n">OpId_21</span>
<span class="w">               </span><span class="nl">model_preluCombined2_add</span><span class="p">:</span><span class="n">OpId_46</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="p">(</span><span class="n">wait</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">13</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">               </span><span class="nl">model_convStart_Conv2D</span><span class="p">:</span><span class="n">OpId_21</span>
<span class="w">            </span><span class="nl">Resources</span><span class="p">:</span><span class="w"> </span><span class="n">HMX</span><span class="p">,</span><span class="w"> </span><span class="n">DMA</span>
<span class="w">      </span><span class="nl">model_add_add</span><span class="p">:</span><span class="n">OpId_54</span><span class="w"> </span><span class="p">(</span><span class="n">cycles</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">62806</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Wait</span><span class="w"> </span><span class="p">(</span><span class="n">Scheduler</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">57481</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">               </span><span class="nl">model_add_add</span><span class="p">:</span><span class="n">OpId_54</span>
<span class="w">               </span><span class="n">Output</span><span class="w"> </span><span class="n">OpId_3</span>
<span class="w">               </span><span class="nl">model_preluCombined1_add</span><span class="p">:</span><span class="n">OpId_37</span>
<span class="w">               </span><span class="nl">model_preluCombined2_add</span><span class="p">:</span><span class="n">OpId_46</span>
<span class="w">               </span><span class="nl">model_convStart_Conv2D</span><span class="p">:</span><span class="n">OpId_21</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="p">(</span><span class="n">wait</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="nl">Resources</span><span class="p">:</span><span class="w"> </span><span class="n">HVX</span>
<span class="w">      </span><span class="n">Output</span><span class="w"> </span><span class="n">OpId_3</span><span class="w"> </span><span class="p">(</span><span class="n">cycles</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="mi">465781</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Wait</span><span class="w"> </span><span class="p">(</span><span class="n">Scheduler</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">430560</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="n">Overlap</span><span class="w"> </span><span class="p">(</span><span class="n">wait</span><span class="p">)</span><span class="w"> </span><span class="n">time</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="w">  </span><span class="n">cycles</span>
<span class="w">            </span><span class="nl">Resources</span><span class="p">:</span><span class="w"> </span><span class="n">HVX</span>
</pre></div>
</div>
<p>The usual sign indicating bottlenecks is present here as well. There are multiple ops with low parallel
execution. PReLU ops are some of the background ops that executed for these ops and the best practices
guidelines suggest that PReLU ops should be replaced with ReLU ops. Changing the graph by replacing the
PReLU ops with ReLU gives us the same model as the one shown in the
<a class="reference internal" href="#qnn-htp-profiling-showcase-model-optimized1-figure"><span class="std std-ref">Showcase Model 1 Optimized</span></a> diagram which is
much better optimized as explained before.</p>
</div>
<div class="section" id="op-writing-guidelines">
<h2>Op Writing Guidelines<a class="headerlink" href="#op-writing-guidelines" title="Permalink to this headline">¶</a></h2>
<p>This section serves as a guide for user to develop custom operations for graphs that can be run on
the HTP backend. It also includes examples which will help user to become familiar with the
different aspects of the HTP core software.</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../HTP/htp_core_headers.html">HTP Core Headers for Op Packages</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../HTP/implementing_ops.html">Implementing Ops</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../HTP/optimization_grammar.html">Optimization Grammar</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../HTP/relu_example.html">QNN HTP Op Package - Relu Op Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../HTP/relu_fp16_example.html">QNN HTP-FP16 Op Package - Relu Op Example</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../HTP/scheduling_and_allocation.html">Scheduling and Allocation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../HTP/scratch_buffer.html">Allocate Memory for Scratch Buffers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../HTP/tensors_and_memory_layout.html">Tensors and Memory Layout</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../HTP/writing_opPackage_migration_guide.html">Op Package Migration Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../HTP/writing_op_package.html">Writing QNN HTP Op Package</a></li>
</ul>
</div>
</div>
<div class="section" id="recommendations-for-network-design">
<h2>Recommendations for Network Design<a class="headerlink" href="#recommendations-for-network-design" title="Permalink to this headline">¶</a></h2>
<p>The HTP supports A8, A16 and FP16 activations. Generally, the accuracy and the power and energy requirements follow the
order A8 &lt; A16 &lt; FP16. Therefore, to minimize power, one should first try the A8 mode and check for accuracy of the results.
If the accuracy is not sufficient try A16 mode and if even that doesn’t achieve the desired accuracy move to FP16 mode.</p>
<p>The following sections cover some of the best practices in graph design that allows for the optimal use of HTP hardware
from a performance and accuracy perspective.</p>
<div class="section" id="performance-and-energy-guidelines">
<h3>Performance and Energy Guidelines<a class="headerlink" href="#performance-and-energy-guidelines" title="Permalink to this headline">¶</a></h3>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../HTP/htp-network-design-recommendations/htp_guidelines_low_depth_activations.html">Avoid Low Depth Activations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../HTP/htp-network-design-recommendations/htp_guidelines_low_depth_activation_more_examples.html">Avoid Low Depth Activations (more examples)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../HTP/htp-network-design-recommendations/htp_guidelines_space_to_depth.html">Use Space-to-depth Transformation where possible</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../HTP/htp-network-design-recommendations/htp_guidelines_tcm_requirements.html">Reducing TCM Requirements for Performance and Functionality</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../HTP/htp-network-design-recommendations/htp_guidelines_activation_functions.html">Choice of Activation Functions</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../HTP/htp-network-design-recommendations/htp_guidelines_channels.html">Number of Channels</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../HTP/htp-network-design-recommendations/htp_guidelines_a16_vs_fp16.html">Quantized 16 bit activations (A16) vs FP16: Performance and power differences</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../HTP/htp-network-design-recommendations/htp_guidelines_avoid_pytorch_to_onnx_conversion.html">Avoid converting PyTorch models to onnx first</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../HTP/htp-network-design-recommendations/htp_guidelines_int4_weights.html">INT4 encodings for weights</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../HTP/htp-network-design-recommendations/htp_guidelines_other_perf.html">Other Performance and Energy Guidelines</a></li>
</ul>
</div>
</div>
<div class="section" id="accuracy-guidelines">
<h3>Accuracy Guidelines<a class="headerlink" href="#accuracy-guidelines" title="Permalink to this headline">¶</a></h3>
<div class="section" id="symmetric-quantization-of-weights">
<h4>Symmetric Quantization of Weights<a class="headerlink" href="#symmetric-quantization-of-weights" title="Permalink to this headline">¶</a></h4>
<p>It is recommended to always use symmetrical quantization of weights when quantizing the model
to obtain best accuracy on HTP based targets. Activation data is recommended to be asymmetric.</p>
</div>
<div class="section" id="quantization-aware-training">
<h4>Quantization Aware Training<a class="headerlink" href="#quantization-aware-training" title="Permalink to this headline">¶</a></h4>
<p>It is recommended to use quantization aware training as much as possible to improve the accuracy
of models especially in the case of high resolution image transformation models. Using quantization aware training may take away the need to use 16bit activations and may allow the use of 8bit activations which will improve both performance and power.
When using quantization aware training, keep in mind the following:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>A comparison of outputs in original framework between original float model and model with fakequant nodes helps in determining the quality of the quantization aware trained model</p></li>
<li><p>Ensure there are fakequant nodes for all layers/kernels</p></li>
</ol>
</div></blockquote>
</div>
</div>
</div>
<div class="section" id="yielding-and-pre-emption">
<h2>Yielding and Pre-Emption<a class="headerlink" href="#yielding-and-pre-emption" title="Permalink to this headline">¶</a></h2>
<p>Yielding and Pre-Emption is a cooperative user-based implementation of
context switching. The following document aims to help the user understand
different concurrency scenarios and their expected behaviour.</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="htp_yielding.html">HTP Yielding</a></li>
</ul>
</div>
</div>
<div class="section" id="vtcm-sharing">
<h2>VTCM Sharing<a class="headerlink" href="#vtcm-sharing" title="Permalink to this headline">¶</a></h2>
<p>Staring from hexagon-v73, it is possible for other threads in the same process to share VTCM resources
with QNN HTP using the procedure described in the following pages:</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="htp_vtcm_sharing.html">VTCM Sharing</a></li>
</ul>
</div>
</div>
<div class="section" id="subsystem-restart-ssr">
<h2>SubSystem Restart (SSR)<a class="headerlink" href="#subsystem-restart-ssr" title="Permalink to this headline">¶</a></h2>
<p>A QNN HTP BE specific feature that allows the CDSP subsystem to automatically restart an invalidated connection
after crashing. Details are provided in the following page:</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="htp_ssr.html">QNN HTP SSR</a></li>
</ul>
</div>
</div>
<div class="section" id="htp-session-artifact-usage-guidlines">
<h2>HTP Session &amp; Artifact Usage Guidlines<a class="headerlink" href="#htp-session-artifact-usage-guidlines" title="Permalink to this headline">¶</a></h2>
<p>QNN only supports one set of libraries per-process. These libraries must be of the same SDK version and
have matching Hexagon architecture versions. For illustrative purposes, V73 Hexagon architecture
libraries will be used in the diagrams; the same guidelines apply for non-V73 artifacts as well. The
supported library layout for QNN is displayed below.</p>
<div class="figure align-center" id="qnn-htp-supported-library-usage-figure">
<img alt="../../_static/resources/qnn_htp_supported_library_usage.png" src="../../_static/resources/qnn_htp_supported_library_usage.png" />
</div>
<p>To prevent incorrect QNN library layouts, Qualcomm recommends the following:</p>
<ul class="simple">
<li><p>One copy of each library should be present for a single process (backend, stub, skel, etc).</p></li>
<li><p>The backend library (libQnnHtp.so) should be explicitly loaded with dlopen rather than being dynamically linked as a dependency.</p></li>
<li><p>Libraries should be in the same directory as one another (the skel is an exception to this so long as the ADSP_LIBRARY_PATH is correctly set to find the library).</p></li>
<li><p>Do not rename libraries to load multiple copies as this is not supported.</p></li>
</ul>
<p>QNN does not support multiple copies of the QNN backend library (libQnnHtp.so) being accessed in a single
process. Two different layouts are depicted below where multiple backend libraries are present on device.</p>
<div class="figure align-center" id="id1">
<img alt="../../_static/resources/qnn_htp_unsupported_library_usage.png" src="../../_static/resources/qnn_htp_unsupported_library_usage.png" />
</div>
<p>For two backend libraries to be loaded, either a second copy of the library is explicitly loaded from a
separate directory than where the first library is located, or a duplicate filesystem is created during
process execution (adb remount for android targets). In either case, the two artifact layouts shown above
are not supported. If these layouts are detected during runtime, QNN_COMMON_ERROR_LOADING_BINARIES will be
returned from the following APIs:</p>
<ul class="simple">
<li><p>QnnBackend_registerOpPackage</p></li>
<li><p>QnnBackend_validateOpConfig</p></li>
<li><p>QnnContext_create</p></li>
<li><p>QnnDevice_create</p></li>
<li><p>QnnGraph_create</p></li>
</ul>
</div>
</div>


           </div>

          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="../../HTP/htp_core_headers.html" class="btn btn-neutral float-right" title="HTP Core Headers for Op Packages" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="../dsp/dsp_backend.html" class="btn btn-neutral float-left" title="DSP" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2020-2023, Qualcomm Technologies, Inc..

    </p>
  </div>



    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a

    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>

    provided by <a href="https://readthedocs.org">Read the Docs</a>.

</footer>
        </div>
      </div>

    </section>

  </div>


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>






</body>
</html>
